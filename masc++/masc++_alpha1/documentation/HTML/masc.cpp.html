<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>masc.cpp</title>
<meta name="generator" content="C++2HTML by Jasper Bedaux" />
<!-- To generate your own colored code visit http://www.bedaux.net/cpp2html/ -->
<style type="text/css">
.comment { color: #999999; font-style: italic; }
.pre { color: #000099; }
.string { color: #009900; }
.char { color: #009900; }
.float { color: #996600; }
.int { color: #999900; }
.bool { color: #000000; font-weight: bold; }
.type { color: #FF6633; }
.flow { color: #FF0000; }
.keyword { color: #990000; }
.operator { color: #663300; font-weight: bold; }
</style>
</head>
<body>
<pre><span class="comment">/* NO its NOT RANDOM the way I format my CODE */</span><span class="pre">

#include "masc.h"
#include&lt;sstream&gt;

#include&lt;stdarg.h&gt;
</span><span class="keyword">


namespace</span> masc<span class="operator"> {</span><span class="keyword">

	using</span> std<span class="operator">::</span>cout<span class="operator">;</span><span class="keyword">

	using</span> std<span class="operator">::</span>endl<span class="operator">;</span><span class="type">

	char</span><span class="operator"> *</span>mysprintf<span class="operator">(</span><span class="type">char</span><span class="operator"> *</span>src<span class="operator">,</span><span class="keyword"> const</span><span class="type"> char</span><span class="operator"> *</span>sptr<span class="operator">, ...) {</span>

		va_list l<span class="operator">;</span><span class="type">
		char</span><span class="operator"> *</span>p<span class="operator">, *</span>sval<span class="operator"> =</span> src<span class="operator">, *</span>ptr<span class="operator">;</span>

		va_start<span class="operator">(</span>l<span class="operator">,</span>sptr<span class="operator">);</span><span class="flow">
		for</span><span class="operator">(</span>p<span class="operator"> =</span><span class="keyword"> const_cast</span><span class="operator">&lt;</span><span class="type">char</span><span class="operator">*&gt;(</span>sptr<span class="operator">); *</span>p<span class="operator">;</span> p<span class="operator">++) {</span><span class="flow">

			if</span><span class="operator">(*</span>p<span class="operator"> !=</span><span class="char"> '%'</span><span class="operator">) {
				*</span>sval<span class="operator"> = *</span>p<span class="operator">;</span>
				sval<span class="operator">++;</span><span class="flow">

				continue</span><span class="operator">;
			}</span><span class="flow">
			else</span><span class="operator"> {</span><span class="flow">
				switch</span><span class="operator">(*++</span>p<span class="operator">) {</span><span class="flow">
					case</span><span class="char"> 'd'</span><span class="operator">: {</span><span class="type">

						int</span> ival<span class="operator"> =</span> va_arg<span class="operator">(</span>l<span class="operator">,</span><span class="type">int</span><span class="operator">);</span>
						std<span class="operator">::</span>ostringstream s<span class="operator">;</span>

						s<span class="operator"> &lt;&lt;</span> ival<span class="operator">;</span>
						std<span class="operator">::</span>string d<span class="operator"> =</span> s<span class="operator">.</span>str<span class="operator">();</span><span class="flow">

						for</span><span class="operator">(</span>size_t i<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> i<span class="operator"> &lt;</span> d<span class="operator">.</span>length<span class="operator">();</span> i<span class="operator">++)
							*</span>sval<span class="operator"> =</span> d<span class="operator">[</span>i<span class="operator">],</span> sval<span class="operator">++;
							  }</span><span class="flow">

							  break</span><span class="operator">;</span><span class="flow">
					case</span><span class="char"> 's'</span><span class="operator">:</span><span class="flow">
						for</span><span class="operator">(</span>ptr<span class="operator"> =</span> va_arg<span class="operator">(</span>l<span class="operator">,</span><span class="type"> char</span><span class="operator">*); *</span>ptr<span class="operator">;</span> ptr<span class="operator">++)
							*</span>sval<span class="operator"> = *</span>ptr<span class="operator">,</span> sval<span class="operator">++;</span><span class="flow"> 
						break</span><span class="operator">;</span><span class="flow">

					case</span><span class="char"> 'f'</span><span class="operator">:
						{</span><span class="type">
							double</span> dval<span class="operator"> =</span> va_arg<span class="operator">(</span>l<span class="operator">,</span><span class="type">double</span><span class="operator">);</span>

							std<span class="operator">::</span>ostringstream s<span class="operator">;</span>
							s<span class="operator"> &lt;&lt;</span> dval<span class="operator">;</span>
							std<span class="operator">::</span>string d<span class="operator"> =</span> s<span class="operator">.</span>str<span class="operator">();</span><span class="flow">

							for</span><span class="operator">(</span>size_t i<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> i<span class="operator"> &lt;</span> d<span class="operator">.</span>length<span class="operator">();</span> i<span class="operator">++)
								*</span>sval<span class="operator"> =</span> d<span class="operator">[</span>i<span class="operator">],</span> sval<span class="operator">++;
						}</span><span class="flow">

						break</span><span class="operator">;</span><span class="flow">
					default</span><span class="operator">:
						*</span>sval<span class="operator"> = *</span>p<span class="operator">;</span>
						sval<span class="operator">++;</span><span class="flow">

						break</span><span class="operator">;
				}
			}

		}
		*</span>sval<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span><span class="flow">
		return</span> src<span class="operator">;
	}</span><span class="type">

	int</span> myprintf<span class="operator">(</span><span class="keyword">const</span><span class="type"> char</span><span class="operator"> *</span>src<span class="operator">, ...) {</span>
		va_list l<span class="operator">;</span><span class="type">

		char</span><span class="operator"> *</span>p<span class="operator">,*</span>ptr<span class="operator">;</span>
		va_start<span class="operator">(</span>l<span class="operator">,</span>src<span class="operator">);</span><span class="flow">

		for</span><span class="operator">(</span>p<span class="operator"> =</span><span class="keyword"> const_cast</span><span class="operator">&lt;</span><span class="type">char</span><span class="operator">*&gt;(</span>src<span class="operator">); *</span>p<span class="operator">;</span> p<span class="operator">++) {</span><span class="flow">

			if</span><span class="operator">(*</span>p<span class="operator"> !=</span><span class="char"> '%'</span><span class="operator">) {</span>
				putchar<span class="operator">(*</span>p<span class="operator">);</span><span class="flow">
				continue</span><span class="operator">;
			}</span><span class="flow">

			else</span><span class="operator"> {</span><span class="flow">
				switch</span><span class="operator">(*++</span>p<span class="operator">) {</span><span class="flow">
					case</span><span class="char"> 'd'</span><span class="operator">: {</span><span class="type">

						int</span> ival<span class="operator"> =</span> va_arg<span class="operator">(</span>l<span class="operator">,</span><span class="type">int</span><span class="operator">);</span>
						std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span> ival<span class="operator">;</span><span class="flow">

						break</span><span class="operator">;
							  }</span><span class="flow">
					case</span><span class="char"> 's'</span><span class="operator">:</span><span class="flow">
						for</span><span class="operator">(</span>ptr<span class="operator"> =</span> va_arg<span class="operator">(</span>l<span class="operator">,</span><span class="type"> char</span><span class="operator">*); *</span>ptr<span class="operator">;</span> ptr<span class="operator">++)</span>

							putchar<span class="operator">(*</span>ptr<span class="operator">);</span><span class="flow">
						break</span><span class="operator">;</span><span class="flow">
					case</span><span class="char"> 'f'</span><span class="operator">:
						{</span><span class="type">
							double</span> dval<span class="operator"> =</span> va_arg<span class="operator">(</span>l<span class="operator">,</span><span class="type">double</span><span class="operator">);</span>

							std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span> dval<span class="operator">;
						}</span><span class="flow">
						break</span><span class="operator">;</span><span class="flow">
					default</span><span class="operator">:</span>

						putchar<span class="operator">(*</span>p<span class="operator">);</span><span class="flow">
						break</span><span class="operator">;
				}
			}

		}</span><span class="flow">
		return</span><span class="int"> 0</span><span class="operator">;
	}</span><span class="type">

	void</span> Symbol_Table<span class="operator">::</span>Set<span class="operator">(</span><span class="type">int</span> type<span class="operator">,</span> std<span class="operator">::</span>string val<span class="operator">,</span> std<span class="operator">::</span>string name<span class="operator">) {</span>

		vars<span class="operator">[</span>name<span class="operator">].</span>name<span class="operator"> =</span> name<span class="operator">;</span>
		vars<span class="operator">[</span>name<span class="operator">].</span>val<span class="operator"> =</span> val<span class="operator">;</span>

		vars<span class="operator">[</span>name<span class="operator">].</span>type<span class="operator"> =</span> type<span class="operator">;
	}</span>

	symb<span class="operator"> &amp;</span>Symbol_Table<span class="operator">::</span>Get<span class="operator">(</span>std<span class="operator">::</span>string name<span class="operator">) {</span><span class="flow">

		return</span> vars<span class="operator">[</span>name<span class="operator">];
	}</span><span class="type">

	void</span> Symbol_Table<span class="operator">::</span>DebugPrint<span class="operator">()</span><span class="keyword"> const</span><span class="operator"> {</span>

		std<span class="operator">::</span>map<span class="operator">&lt;</span>std<span class="operator">::</span>string<span class="operator">,</span>symb<span class="operator">&gt;::</span>const_iterator i<span class="operator">;</span><span class="flow">
		for</span><span class="operator">(</span>i<span class="operator"> =</span> vars<span class="operator">.</span>begin<span class="operator">();</span> i<span class="operator"> !=</span> vars<span class="operator">.</span>end<span class="operator">();</span> i<span class="operator">++)</span>

			std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span><span class="string"> "Variable name: "</span><span class="operator"> &lt;&lt;</span> i<span class="operator">-&gt;</span>first<span class="operator"> &lt;&lt;</span><span class="string"> " Variable value: "</span><span class="operator"> &lt;&lt;</span> i<span class="operator">-&gt;</span>second<span class="operator">.</span>val<span class="operator"> &lt;&lt;</span><span class="char"> '\n'</span><span class="operator">;
	}</span>

	symb<span class="operator"> &amp;</span>Symbol_Table<span class="operator">::</span><span class="keyword">operator</span><span class="operator">() (</span> size_t pos<span class="operator"> ) {</span>
		std<span class="operator">::</span>list<span class="operator">&lt;</span>symb<span class="operator">&gt;::</span>iterator i<span class="operator"> =</span> st<span class="operator">.</span>begin<span class="operator">();</span><span class="flow">

		for</span><span class="operator">(</span>size_t z<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> z<span class="operator"> &lt;</span> pos<span class="operator">;</span> z<span class="operator">++)</span>

			i<span class="operator">++;</span><span class="flow">
		return</span><span class="operator"> *</span>i<span class="operator">;
	}</span>

	symb Symbol_Table<span class="operator">::</span>Pop<span class="operator">() {</span><span class="flow">

		if</span><span class="operator">(!</span>st<span class="operator">.</span>empty<span class="operator">()) {</span>
			symb p<span class="operator"> =</span> st<span class="operator">.</span>back<span class="operator">();</span>

			st<span class="operator">.</span>pop_back<span class="operator">();</span><span class="flow">
			return</span> p<span class="operator">;
		}</span><span class="flow">
		return</span> symb<span class="operator">();
	}</span><span class="type">

	void</span> Symbol_Table<span class="operator">::</span><span class="keyword">operator</span><span class="operator">+=(</span><span class="keyword">const</span> symb<span class="operator"> &amp;</span>s<span class="operator">) {</span>
		st<span class="operator">.</span>push_back<span class="operator">(</span>s<span class="operator">);
	}</span>

	symb Symbol_Table<span class="operator">::</span><span class="keyword">operator</span><span class="operator">--() {</span><span class="flow">
		return</span> Pop<span class="operator">();
	}</span><span class="type">

	void</span> Symbol_Table<span class="operator">::</span>PopAll<span class="operator">() {</span><span class="flow">

		while</span><span class="operator">(!</span>st<span class="operator">.</span>empty<span class="operator">())</span>
			st<span class="operator">.</span>pop_back<span class="operator">();
	}</span><span class="type">

	void</span> Symbol_Table<span class="operator">::</span>Push<span class="operator">(</span>symb<span class="operator"> &amp;</span>s<span class="operator">) {</span>

		st<span class="operator">.</span>push_back<span class="operator">(</span>s<span class="operator">);
	}</span>


	Parser<span class="operator">::</span>Parser<span class="operator">(</span>std<span class="operator">::</span>string s<span class="operator">) :</span> MFile<span class="operator">(</span>s<span class="operator">) ,</span> err<span class="operator">(</span><span class="int">0</span><span class="operator">) ,</span> current_line<span class="operator">(</span><span class="int">0</span><span class="operator">) {</span><span class="flow">

		if</span><span class="operator">(</span>opened<span class="operator"> ==</span><span class="bool"> true</span><span class="operator">) {</span>
			GetLine<span class="operator">();</span>
			Begin<span class="operator">();
		}</span><span class="flow">

		else</span><span class="operator"> {</span>
			current_line<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span>
			ErrorMsg<span class="operator">(</span><span class="string">"Couldnt open file (%s)\n"</span><span class="operator">,</span> s<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">

			return</span><span class="operator">;
		}

	}</span><span class="type">

	void</span> Parser<span class="operator">::</span>StartParse<span class="operator">(</span>std<span class="operator">::</span>string str<span class="operator">) {</span>

		opened<span class="operator"> =</span><span class="bool"> false</span><span class="operator">;</span>
		Open<span class="operator">(</span>str<span class="operator">);</span><span class="flow">
		if</span><span class="operator">(</span>opened<span class="operator"> ==</span><span class="bool"> true</span><span class="operator">) {</span>

			GetLine<span class="operator">();</span>
			Begin<span class="operator">();
		}</span><span class="flow">
		else</span><span class="operator"> {</span>
			current_line<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span>

			ErrorMsg<span class="operator">(</span><span class="string">"Couldnt open file (%s)\n"</span><span class="operator">,</span> str<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
			return</span><span class="operator">;
		}
	}</span><span class="type">

	void</span> Parser<span class="operator">::</span>Begin<span class="operator">() {</span>

		Parse<span class="operator">(</span>cur_line<span class="operator">);</span><span class="flow">
		if</span><span class="operator">(!</span>GetLine<span class="operator">())</span>
			Begin<span class="operator">();
	}</span><span class="type">

	void</span> Parser<span class="operator">::</span>Parse<span class="operator">(</span>std<span class="operator">::</span>string str<span class="operator">) {</span>
		std<span class="operator">::</span>string<span class="operator">::</span>iterator p<span class="operator">;</span>

		std<span class="operator">::</span>string cur_tok<span class="operator"> =</span><span class="string"> ""</span><span class="operator">;</span>
		cur<span class="operator">.</span>line_num<span class="operator"> =</span> curline<span class="operator">;</span>

		cur<span class="operator">.</span>source_file<span class="operator"> =</span> file_name<span class="operator">;</span>
		cur<span class="operator">.</span>token<span class="operator"> =</span><span class="string"> ""</span><span class="operator">;</span>

				
		str<span class="operator"> +=</span><span class="string"> "\n"</span><span class="operator">;</span><span class="flow">
		if</span><span class="operator">(</span>str<span class="operator">.</span>find<span class="operator">(</span><span class="string">"insert"</span><span class="operator">) != -</span><span class="int">1</span><span class="operator"> &amp;&amp;</span> str<span class="operator">.</span>find<span class="operator">(</span><span class="char">'\"'</span><span class="operator">) != -</span><span class="int">1</span><span class="operator"> &amp;&amp;</span> str<span class="operator">.</span>find<span class="operator">(</span><span class="string">";"</span><span class="operator">) != -</span><span class="int">1</span><span class="operator">) {</span>

			std<span class="operator">::</span>string insert_file<span class="operator">;</span>
			insert_file<span class="operator"> =</span> str<span class="operator">.</span>substr<span class="operator">(</span>str<span class="operator">.</span>find<span class="operator">(</span><span class="char">'\"'</span><span class="operator">)+</span><span class="int">1</span><span class="operator">,</span> str<span class="operator">.</span>length<span class="operator">());</span><span class="flow">

			if</span><span class="operator">(</span>insert_file<span class="operator">.</span>find<span class="operator">(</span><span class="char">'\"'</span><span class="operator">) != -</span><span class="int">1</span><span class="operator">)</span>
				insert_file<span class="operator"> =</span>  insert_file<span class="operator">.</span>substr<span class="operator">(</span><span class="int">0</span><span class="operator">,</span> insert_file<span class="operator">.</span>find<span class="operator">(</span><span class="char">'\"'</span><span class="operator">));</span>

			insert_vec<span class="operator">.</span>push_back<span class="operator">(</span>insert_file<span class="operator">);
		}</span><span class="flow">
		for</span><span class="operator">(</span>p<span class="operator"> =</span> str<span class="operator">.</span>begin<span class="operator">();</span> p<span class="operator"> !=</span> str<span class="operator">.</span>end<span class="operator">();</span> p<span class="operator">++) {</span><span class="flow">

			if</span><span class="operator">(*</span>p<span class="operator"> ==</span><span class="char"> '/'</span><span class="operator">)</span><span class="flow">
				return</span><span class="operator">;</span><span class="flow">

			if</span><span class="operator">(</span>isalpha<span class="operator">(*</span>p<span class="operator">)) {</span>

				cur_tok<span class="operator"> =</span><span class="string"> ""</span><span class="operator">;</span><span class="flow">
				while</span><span class="operator">(*</span>p<span class="operator"> !=</span><span class="char"> '\n'</span><span class="operator"> &amp;&amp; (</span>isalpha<span class="operator">(*</span>p<span class="operator">) ||</span> isdigit<span class="operator">(*</span>p<span class="operator">) || *</span>p<span class="operator"> ==</span><span class="char"> '_'</span><span class="operator">  || *</span>p<span class="operator"> ==</span><span class="char"> '$'</span><span class="operator"> || *</span>p<span class="operator"> ==</span><span class="char"> '&amp;'</span><span class="operator"> || *</span>p<span class="operator"> ==</span><span class="char"> '#'</span><span class="operator"> || *</span>p<span class="operator"> ==</span><span class="char"> '.'</span><span class="operator"> || *</span>p<span class="operator"> ==</span><span class="char"> '['</span><span class="operator"> || *</span>p<span class="operator"> ==</span><span class="char"> ']'</span><span class="operator">) &amp;&amp;</span> p<span class="operator"> !=</span> str<span class="operator">.</span>end<span class="operator">()) {</span>

					cur_tok<span class="operator"> += *</span>p<span class="operator">;</span>
					p<span class="operator">++;
				}</span><span class="flow">
				if</span><span class="operator">(*</span>p<span class="operator"> !=</span><span class="char"> ':'</span><span class="operator">)</span>

					cur<span class="operator">.</span>type<span class="operator"> =</span> IDENTIFIER<span class="operator">;</span><span class="flow">
				else</span>
					cur<span class="operator">.</span>type<span class="operator"> =</span> CODELABEL<span class="operator">;</span>

				cur<span class="operator">.</span>token<span class="operator"> =</span> cur_tok<span class="operator">;</span>
				tok_vec<span class="operator">.</span>push_back<span class="operator">(</span>cur<span class="operator">);</span>

				cur_tok<span class="operator"> =</span><span class="string"> ""</span><span class="operator">;
			}</span><span class="flow"> 
			else if</span><span class="operator">(</span>isdigit<span class="operator">(*</span>p<span class="operator">)) {</span>
				cur_tok<span class="operator"> =</span><span class="string"> ""</span><span class="operator">;</span><span class="flow">

				while</span><span class="operator">((</span>isdigit<span class="operator">(*</span>p<span class="operator">) || *</span>p<span class="operator"> ==</span><span class="char"> '.'</span><span class="operator">) &amp;&amp;</span> p<span class="operator"> !=</span> str<span class="operator">.</span>end<span class="operator">()) {</span>

					cur_tok<span class="operator"> += *</span>p<span class="operator">;</span>
					p<span class="operator">++;
				}</span>
				cur<span class="operator">.</span>token<span class="operator"> =</span> cur_tok<span class="operator">;</span>

				cur<span class="operator">.</span>type<span class="operator"> =</span> DIGIT<span class="operator">;</span>
				tok_vec<span class="operator">.</span>push_back<span class="operator">(</span>cur<span class="operator">);
			}</span><span class="flow">

			else if</span><span class="operator">(*</span>p<span class="operator"> ==</span><span class="char"> '\"'</span><span class="operator">) {</span>
				p<span class="operator">++;</span><span class="flow">
				while</span><span class="operator">(*</span>p<span class="operator"> !=</span><span class="char"> '\"'</span><span class="operator"> &amp;&amp;</span> p<span class="operator"> !=</span> str<span class="operator">.</span>end<span class="operator">()) {</span><span class="flow">

					if</span><span class="operator">(*</span>p<span class="operator"> !=</span><span class="char"> '\\'</span><span class="operator">) {</span>

						cur_tok<span class="operator"> += *</span>p<span class="operator">;</span>

						p<span class="operator">++;

					}</span><span class="flow">
					else 
						if</span><span class="operator">(*</span>p<span class="operator"> ==</span><span class="char"> '\\'</span><span class="operator">)
						{</span>
							p<span class="operator">++;</span><span class="flow">

							if</span><span class="operator">(*</span>p<span class="operator"> ==</span><span class="char"> '\"'</span><span class="operator">)</span>
								cur_tok<span class="operator"> += *</span>p<span class="operator">,</span> p<span class="operator">++;</span><span class="flow">

							else if</span><span class="operator">(*</span>p<span class="operator"> ==</span><span class="char"> 'n'</span><span class="operator">)</span>
								cur_tok<span class="operator"> +=</span><span class="char"> '\n'</span><span class="operator">,</span> p<span class="operator">++;
						}

				}</span>

				cur<span class="operator">.</span>token<span class="operator"> =</span> cur_tok<span class="operator">;</span>
				cur<span class="operator">.</span>type<span class="operator"> =</span> STRING<span class="operator">;</span>

				tok_vec<span class="operator">.</span>push_back<span class="operator">(</span>cur<span class="operator">);</span>
				cur_tok<span class="operator"> =</span><span class="string"> ""</span><span class="operator">;
			}</span><span class="flow">

			switch</span><span class="operator">(*</span>p<span class="operator">) {</span><span class="flow">
				case</span><span class="char"> '{'</span><span class="operator">:</span><span class="flow">
				case</span><span class="char"> '}'</span><span class="operator">:</span><span class="flow">

				case</span><span class="char"> ';'</span><span class="operator">:</span><span class="flow">
				case</span><span class="char"> ','</span><span class="operator">:</span><span class="flow">
				case</span><span class="char"> '='</span><span class="operator">:</span><span class="flow">

				case</span><span class="char"> '&lt;'</span><span class="operator">:</span><span class="flow">
				case</span><span class="char"> '~'</span><span class="operator">:</span><span class="flow">
				case</span><span class="char"> '\''</span><span class="operator">:</span><span class="flow">

				case</span><span class="char"> '@'</span><span class="operator">:</span><span class="flow">
				case</span><span class="char"> '!'</span><span class="operator">:</span><span class="flow">
				case</span><span class="char"> '#'</span><span class="operator">:</span><span class="flow">

				case</span><span class="char"> '$'</span><span class="operator">:</span><span class="flow">
				case</span><span class="char"> '%'</span><span class="operator">:</span><span class="flow">
				case</span><span class="char"> '^'</span><span class="operator">:</span><span class="flow">

				case</span><span class="char"> '&amp;'</span><span class="operator">:</span><span class="flow">
				case</span><span class="char"> '*'</span><span class="operator">:</span><span class="flow">
				case</span><span class="char"> '('</span><span class="operator">:</span><span class="flow">

				case</span><span class="char"> ')'</span><span class="operator">:</span><span class="flow">
				case</span><span class="char"> '-'</span><span class="operator">:</span><span class="flow">
				case</span><span class="char"> '+'</span><span class="operator">:</span><span class="flow">

				case</span><span class="char"> '/'</span><span class="operator">:</span><span class="flow">
				case</span><span class="char"> '\\'</span><span class="operator">:</span><span class="flow">
				case</span><span class="char"> '.'</span><span class="operator">:</span><span class="flow">

				case</span><span class="char"> '&gt;'</span><span class="operator">:</span><span class="flow">
				case</span><span class="char"> ':'</span><span class="operator">:</span><span class="flow">
					if</span><span class="operator">(*(</span>p<span class="operator">+</span><span class="int">1</span><span class="operator">) ==</span><span class="char"> '&lt;'</span><span class="operator">) {</span>

						p<span class="operator">++;
					}</span>
					cur<span class="operator">.</span>token<span class="operator"> = *</span>p<span class="operator">;</span>
					cur<span class="operator">.</span>type<span class="operator"> = *</span>p<span class="operator">;</span> 
					tok_vec<span class="operator">.</span>push_back<span class="operator">(</span>cur<span class="operator">);</span>

					cur_tok<span class="operator"> =</span><span class="string"> ""</span><span class="operator">;</span><span class="flow">
					break</span><span class="operator">;
			}
		}
	}</span><span class="type">

	void</span> Parser<span class="operator">::</span>DebugTokens<span class="operator">() {</span><span class="flow">

		for</span><span class="operator">(</span><span class="type">unsigned int</span> i<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> i<span class="operator"> &lt;</span> tok_vec<span class="operator">.</span>size<span class="operator">();</span> i<span class="operator">++)</span>

			cout<span class="operator"> &lt;&lt;</span><span class="string"> "token (type:"</span><span class="operator"> &lt;&lt;</span><span class="type"> int</span><span class="operator">(</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator">) &lt;&lt;</span><span class="string"> ") "</span><span class="operator"> &lt;&lt;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator"> &lt;&lt;</span> endl<span class="operator">;
	}</span><span class="type">

	void</span> Parser<span class="operator">::</span>ErrorMsg<span class="operator">(</span><span class="keyword">const</span><span class="type"> char</span><span class="operator"> *</span>str<span class="operator">, ...) {</span>
		va_list l<span class="operator">;</span><span class="type">

		char</span> error_msg<span class="operator">[</span><span class="int">5000</span><span class="operator">];</span>
		va_start<span class="operator">(</span>l<span class="operator">,</span>str<span class="operator">);</span>
		vsprintf<span class="operator">(</span><span class="keyword">const_cast</span><span class="operator">&lt;</span><span class="type">char</span><span class="operator">*&gt;(</span>error_msg<span class="operator">),</span>str<span class="operator">,</span>l<span class="operator">);</span>

		va_end<span class="operator">(</span>l<span class="operator">);</span>
		cout<span class="operator"> &lt;&lt;</span><span class="string"> "**** error#: "</span><span class="operator"> &lt;&lt; (++</span>err<span class="operator">) &lt;&lt;</span><span class="string"> " "</span><span class="operator"> &lt;&lt;</span> error_msg<span class="operator"> &lt;&lt;</span><span class="string"> " \n\t-&gt;line("</span><span class="operator"> &lt;&lt;</span> current_line<span class="operator"> &lt;&lt;</span><span class="string"> ").file("</span><span class="operator"> &lt;&lt;</span> current_file<span class="operator"> &lt;&lt;</span><span class="string"> ") "</span><span class="operator"> &lt;&lt;</span> endl<span class="operator">;
	}</span><span class="type">

	bool</span> Parser<span class="operator">::</span>LexAnayalize<span class="operator">() {</span><span class="type">

		int</span> masteronLucy<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span>

		std<span class="operator">::</span>string obj_name<span class="operator"> =</span><span class="string"> ""</span><span class="operator">;</span><span class="flow">
			
		for</span><span class="operator">(</span><span class="type">unsigned int</span> z<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> z<span class="operator"> &lt;</span> tok_vec<span class="operator">.</span>size<span class="operator">();</span> z<span class="operator">++) {</span>

			current_line<span class="operator"> =</span> tok_vec<span class="operator">[</span>z<span class="operator">].</span>line_num<span class="operator">;</span>
			current_file<span class="operator"> =</span> tok_vec<span class="operator">[</span>z<span class="operator">].</span>source_file<span class="operator">;</span><span class="type">

			int</span> vid<span class="operator"> =</span> IdentToValue<span class="operator">(</span>tok_vec<span class="operator">[</span>z<span class="operator">].</span>token<span class="operator">);</span><span class="flow">

			if</span><span class="operator">(</span>vid<span class="operator"> ==</span> TOK_USES<span class="operator">) {</span>
				std<span class="operator">::</span>map<span class="operator">&lt;</span>std<span class="operator">::</span>string<span class="operator">,</span>masc<span class="operator">::</span>External_Callback<span class="operator">&gt;::</span>iterator itz<span class="operator">;</span><span class="flow">

				for</span><span class="operator">(</span>itz<span class="operator"> =</span> GetBend<span class="operator">()-&gt;</span>callb<span class="operator">.</span>begin<span class="operator">();</span> itz<span class="operator"> !=</span> GetBend<span class="operator">()-&gt;</span>callb<span class="operator">.</span>end<span class="operator">();</span> itz<span class="operator">++) {</span><span class="flow">

					if</span><span class="operator">(</span>itz<span class="operator">-&gt;</span>second<span class="operator">.</span>imp<span class="operator"> ==</span><span class="bool"> true</span><span class="operator"> &amp;&amp;</span> itz<span class="operator">-&gt;</span>second<span class="operator">.</span>isdef<span class="operator"> ==</span><span class="bool"> false</span><span class="operator">) {</span>

						std<span class="operator">::</span>map<span class="operator">&lt;</span>std<span class="operator">::</span>string<span class="operator">,</span>std<span class="operator">::</span>string<span class="operator">&gt;::</span>iterator it<span class="operator">;</span><span class="type">
						bool</span> found_it<span class="operator"> =</span><span class="bool"> false</span><span class="operator">;</span><span class="flow">

						for</span><span class="operator">(</span>it<span class="operator"> =</span> GetBend<span class="operator">()-&gt;</span>obj<span class="operator">.</span>begin<span class="operator">();</span> it<span class="operator"> !=</span> GetBend<span class="operator">()-&gt;</span>obj<span class="operator">.</span>end<span class="operator">();</span> it<span class="operator">++) {</span><span class="flow">

							if</span><span class="operator">(</span>GetBend<span class="operator">()-&gt;</span>Find<span class="operator">(</span>it<span class="operator">-&gt;</span>second<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> itz<span class="operator">-&gt;</span>second<span class="operator">.</span>other_name<span class="operator">) !=</span><span class="int"> 0</span><span class="operator"> ||</span> GetBend<span class="operator">()-&gt;</span>Find<span class="operator">(</span><span class="string">"master."</span><span class="operator"> +</span> itz<span class="operator">-&gt;</span>second<span class="operator">.</span>other_name<span class="operator">) !=</span><span class="int"> 0</span><span class="operator">) {</span>

								found_it<span class="operator"> =</span><span class="bool"> true</span><span class="operator">;</span><span class="flow">
								break</span><span class="operator">;
							}

						}</span><span class="flow">
						if</span><span class="operator">(</span>found_it<span class="operator"> ==</span><span class="bool"> false</span><span class="operator">) {</span>

							ErrorMsg<span class="operator">(</span><span class="string">" (fatal) procedure (%s) not implemented yet is defined to be so "</span><span class="operator">,</span> itz<span class="operator">-&gt;</span>second<span class="operator">.</span>name<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
							return</span><span class="bool"> false</span><span class="operator">;
						}
					}
				}

			}</span><span class="flow">

			else if</span><span class="operator">(</span>tok_vec<span class="operator">[</span>z<span class="operator">].</span>type<span class="operator"> ==</span><span class="char"> '{'</span><span class="operator"> &amp;&amp;</span> pBounds<span class="operator">(</span>z<span class="operator">-</span><span class="int">4</span><span class="operator">)) {</span><span class="type">

				int</span> zid<span class="operator"> =</span> IdentToValue<span class="operator">(</span>tok_vec<span class="operator">[</span>z<span class="operator">-</span><span class="int">1</span><span class="operator">].</span>token<span class="operator">),</span> zzid<span class="operator"> =</span> IdentToValue<span class="operator">(</span>tok_vec<span class="operator">[</span>z<span class="operator">-</span><span class="int">2</span><span class="operator">].</span>token<span class="operator">);</span><span class="flow">

				if</span><span class="operator">(</span>zid<span class="operator"> == -</span><span class="int">1</span><span class="operator"> &amp;&amp;</span> zzid<span class="operator"> !=</span> TOK_PROC<span class="operator"> &amp;&amp;</span> zzid<span class="operator"> !=</span> TOK_EXTERN<span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>z<span class="operator">-</span><span class="int">4</span><span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '}'</span><span class="operator"> &amp;&amp;</span> GetBend<span class="operator">()-&gt;</span>obj<span class="operator">[</span>tok_vec<span class="operator">[</span>z<span class="operator">-</span><span class="int">1</span><span class="operator">].</span>token<span class="operator">] ==</span><span class="string"> ""</span><span class="operator">) {</span>

					ErrorMsg<span class="operator">(</span><span class="string">"Invalid object/uses/procedure name on opening block you put (%s)"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>z<span class="operator">-</span><span class="int">1</span><span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span>

					z<span class="operator">++;</span><span class="flow">
					continue</span><span class="operator">;
				}
			}</span><span class="flow">
			else if</span><span class="operator">(</span>pBounds<span class="operator">(</span>z<span class="operator">-</span><span class="int">1</span><span class="operator">) &amp;&amp; (</span>vid<span class="operator"> ==</span> TOK_USES<span class="operator"> ||</span> vid<span class="operator"> ==</span> TOK_BEGIN<span class="operator"> ||</span> vid<span class="operator"> ==</span> TOK_END<span class="operator"> ||</span> vid<span class="operator"> ==</span> TOK_PROC<span class="operator"> ||</span> vid<span class="operator"> ==</span> TOK_MAS<span class="operator"> ||</span> vid<span class="operator"> ==</span> TOK_MAIN<span class="operator">) &amp;&amp;</span> pBounds<span class="operator">(</span>z<span class="operator">-</span><span class="int">1</span><span class="operator">)) {</span><span class="type">

			   int</span> rid<span class="operator"> =</span> IdentToValue<span class="operator">(</span>tok_vec<span class="operator">[</span>z<span class="operator">-</span><span class="int">1</span><span class="operator">].</span>token<span class="operator">);</span><span class="flow">

				if</span><span class="operator">(</span>rid<span class="operator"> == -</span><span class="int">1</span><span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>z<span class="operator">-</span><span class="int">1</span><span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> ';'</span><span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>z<span class="operator">-</span><span class="int">1</span><span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '}'</span><span class="operator">) {</span>

					ErrorMsg<span class="operator">(</span><span class="string">"Error bad value before keyword (%s) i found (%s)"</span><span class="operator">,</span> tok_array<span class="operator">[</span>vid<span class="operator">],</span> tok_vec<span class="operator">[</span>z<span class="operator">-</span><span class="int">1</span><span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span>

					z<span class="operator">++;</span><span class="flow">
					continue</span><span class="operator">;
				}</span><span class="flow"> 
				else</span><span class="operator"> {</span><span class="flow">
					if</span><span class="operator">((</span>vid<span class="operator"> ==</span> TOK_MAS<span class="operator"> ||</span> vid<span class="operator"> ==</span> TOK_MAIN<span class="operator">) &amp;&amp;</span> pBounds<span class="operator">(</span>z<span class="operator">+</span><span class="int">1</span><span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>z<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>type<span class="operator"> ==</span> IDENTIFIER<span class="operator">) {</span>

						obj_name<span class="operator"> =</span> tok_vec<span class="operator">[</span>z<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>token<span class="operator">;</span><span class="flow">
						continue</span><span class="operator">;
					}
				}

			}</span><span class="flow">

			else if</span><span class="operator">(</span>vid<span class="operator"> ==</span> TOK_IMPLEMENT<span class="operator">) {</span><span class="flow">
				if</span><span class="operator">(</span>pBounds<span class="operator">(++</span>z<span class="operator">) &amp;&amp; (</span>vid<span class="operator"> =</span> IdentToValue<span class="operator">(</span>tok_vec<span class="operator">[</span>z<span class="operator">].</span>token<span class="operator">)) ==</span> TOK_PROC<span class="operator"> &amp;&amp;</span> pBounds<span class="operator">(++</span>z<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>z<span class="operator">].</span>type<span class="operator"> ==</span> IDENTIFIER<span class="operator"> &amp;&amp;</span> pBounds<span class="operator">(++</span>z<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>z<span class="operator">].</span>type<span class="operator"> ==</span><span class="char"> ';'</span><span class="operator">) {</span><span class="flow">

					if</span><span class="operator">(</span>pBounds<span class="operator">(</span>z<span class="operator">-</span><span class="int">1</span><span class="operator">) &amp;&amp;</span> GetBend<span class="operator">()-&gt;</span>callb<span class="operator">[</span>obj_name<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> tok_vec<span class="operator">[</span>z<span class="operator">-</span><span class="int">1</span><span class="operator">].</span>token<span class="operator">].</span>imp<span class="operator"> ==</span><span class="bool"> false</span><span class="operator">) {</span>

						ErrorMsg<span class="operator">(</span><span class="string">"implemented procedure is missing from object (%s)"</span><span class="operator"> ,</span><span class="string">""</span><span class="operator">);</span><span class="flow">
						continue</span><span class="operator">;
					}

				}</span><span class="flow">
				else</span><span class="operator">	{</span>

					ErrorMsg<span class="operator">(</span><span class="string">" there is a problem with the implement keyword probaly you forgot a semi-colon,proc keyword, or name "</span><span class="operator">);

				}</span>

				z<span class="operator">++;

			}

		}</span>
		current_line<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span><span class="type">

		int</span> ID<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span><span class="flow">

		for</span><span class="operator">(</span><span class="type">unsigned int</span> i<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span>  i<span class="operator"> &lt;</span> tok_vec<span class="operator">.</span>size<span class="operator">();</span> i<span class="operator">++) {</span>

			current_line<span class="operator"> =</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>line_num<span class="operator">;</span>
			current_file<span class="operator"> =</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>source_file<span class="operator">;</span><span class="flow">

			switch</span><span class="operator">(</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator">) {</span><span class="flow">
				case</span> IDENTIFIER<span class="operator">:
					{</span><span class="type">
						int</span> id<span class="operator"> =</span> IdentToValue<span class="operator">(</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">);</span><span class="flow">

						switch</span><span class="operator">(</span>id<span class="operator">) 
						{</span><span class="flow">
						case</span> TOK_USES<span class="operator">:
							{</span><span class="flow">
								if</span><span class="operator">(</span>pBounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">3</span><span class="operator">) &amp;&amp; (</span>tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>type<span class="operator"> ==</span><span class="char"> '{'</span><span class="operator">)) {</span>

									i<span class="operator">+=</span><span class="int">2</span><span class="operator">;</span><span class="flow">
									while</span><span class="operator">(</span>pBounds<span class="operator">(</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '}'</span><span class="operator">) {</span><span class="flow">

										if</span><span class="operator">(</span>pBounds<span class="operator">(</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> ';'</span><span class="operator"> &amp;&amp;</span> GetBend<span class="operator">()-&gt;</span>obj<span class="operator">[</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">] !=</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">) {</span>

											ErrorMsg<span class="operator">(</span><span class="string">"Error uses block is trying to inhert from a unknown object (%s)\n"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span>
											i<span class="operator">++;</span><span class="flow">

											continue</span><span class="operator">;
										}</span>
										i<span class="operator">++;
									}
								}

							}</span><span class="flow">
							break</span><span class="operator">;</span><span class="flow">
						case</span> TOK_INSERT<span class="operator">:
							{</span>

								i<span class="operator">++;</span><span class="flow">
								if</span><span class="operator">(</span>pBounds<span class="operator">(</span>i<span class="operator">)) {</span>
									std<span class="operator">::</span>fstream f<span class="operator">;</span>

									f<span class="operator">.</span>open<span class="operator">(</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">(),</span> std<span class="operator">::</span>ios<span class="operator">::</span>in<span class="operator">);</span><span class="flow">

									if</span><span class="operator">(</span>f<span class="operator">.</span>is_open<span class="operator">())
									{</span>  f<span class="operator">.</span>close<span class="operator">();</span><span class="flow"> continue</span><span class="operator">; }</span><span class="flow">
									else</span>

										f<span class="operator">.</span>close<span class="operator">(),</span> ErrorMsg<span class="operator">(</span><span class="string">"insert not including a file instead I found %s"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">

									continue</span><span class="operator">;
								}
							}</span><span class="flow">
							break</span><span class="operator">;</span><span class="flow">
						case</span> TOK_MAS<span class="operator">:</span><span class="flow"> 
						case</span> TOK_MAIN<span class="operator">:
							{</span><span class="flow">

								if</span><span class="operator">(</span>id<span class="operator"> ==</span> TOK_MAIN<span class="operator">) {</span>
									masteronLucy<span class="operator">++;</span><span class="flow">
									if</span><span class="operator">(</span>masteronLucy<span class="operator"> &gt;=</span><span class="int"> 2</span><span class="operator">) {</span>

										ErrorMsg<span class="operator">(</span><span class="string">"(fatal) more than one main object cannot continue try only putting one master object in your script."</span><span class="operator">);</span><span class="flow">
										return</span><span class="bool"> false</span><span class="operator">;
									}
								}</span><span class="flow">
								if</span><span class="operator">(</span>pBounds<span class="operator">(++</span>i<span class="operator">)) {</span><span class="type">

									int</span> tid<span class="operator"> =</span> IdentToValue<span class="operator">(</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">);</span><span class="flow">
									if</span><span class="operator">(</span>tid<span class="operator"> &gt;=</span> TOK_INSERT<span class="operator"> &amp;&amp;</span> tid<span class="operator"> &lt;=</span> VAR_FLOAT<span class="operator">) {</span>

										ErrorMsg<span class="operator">(</span><span class="string">"mas(ter) keyword found another keyword (%s) instead of name of the object."</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
										continue</span><span class="operator">;
									}</span><span class="flow">

									else if</span><span class="operator">(</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> ==</span> DIGIT<span class="operator"> ||</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> ==</span> STRING<span class="operator"> || (</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> &gt;=</span><span class="char"> '!'</span><span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> &lt;=</span><span class="char"> '@'</span><span class="operator">) || (</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> &gt;=</span><span class="char"> '{'</span><span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> &lt;=</span><span class="char"> '~'</span><span class="operator">)) {</span>

										ErrorMsg<span class="operator">(</span><span class="string">"mas(ter) keyword found a digit,string,or special character instead of identifier (%s)"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
										continue</span><span class="operator">;
									}
								}</span>

								ID<span class="operator">++;
							}</span><span class="flow">
							break</span><span class="operator">;</span><span class="flow">
						case</span> TOK_VAR<span class="operator">:
							{</span>
								ID<span class="operator">++;</span>

								i<span class="operator">++;</span><span class="flow">
								if</span><span class="operator">(</span>pBounds<span class="operator">(</span>i<span class="operator">) &amp;&amp;</span> pBounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">)) {</span><span class="flow">

									if</span><span class="operator">(</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '{'</span><span class="operator">) {</span>
										ErrorMsg<span class="operator">(</span><span class="string">"(fatal) variable code block missing opening brace instead I found (%s) "</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">

										return</span><span class="bool"> false</span><span class="operator">;
									}
								}</span><span class="flow">

								while</span><span class="operator">(</span>pBounds<span class="operator">(++</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '}'</span><span class="operator">) {</span>

									current_line<span class="operator"> =</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>line_num<span class="operator">;</span>
									current_file<span class="operator"> =</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>source_file<span class="operator">;</span><span class="type">

									int</span> zid<span class="operator"> =</span> IdentToValue<span class="operator">(</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">);</span><span class="flow">
									if</span><span class="operator">(</span>zid<span class="operator"> &gt;=</span> TOK_USES<span class="operator"> &amp;&amp;</span> zid<span class="operator"> &lt;=</span> TOK_EXTERN<span class="operator">) {</span>

										ErrorMsg<span class="operator">(</span><span class="string">"(fatal) found keyword (%s) instead of variable decleration (maybe you forgot } or \")"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
										return</span><span class="bool"> false</span><span class="operator">;
									}</span><span class="flow">

									if</span><span class="operator">(</span>zid<span class="operator"> &gt;=</span> VAR_INTEGER<span class="operator"> &amp;&amp;</span> zid<span class="operator"> &lt;=</span> VAR_FLOAT<span class="operator">) {</span><span class="flow">

										if</span><span class="operator">(</span>pBounds<span class="operator">(++</span>i<span class="operator">)) {</span><span class="flow">
											if</span><span class="operator">(</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span> IDENTIFIER<span class="operator">) {</span>

												ErrorMsg<span class="operator">(</span><span class="string">" found a string,digit,or special character (%s) instead of a identifier for variable name!"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
												continue</span><span class="operator">;
											}</span><span class="flow">

											else if</span><span class="operator">(</span>pBounds<span class="operator">(++</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '='</span><span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> ';'</span><span class="operator">) {</span>

												ErrorMsg<span class="operator">(</span><span class="string">" found %s instead of equal sign or semi-colon."</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
												continue</span><span class="operator">;

											}</span><span class="flow">

											else if</span><span class="operator">(</span>pBounds<span class="operator">(</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> ==</span><span class="char"> '='</span><span class="operator"> &amp;&amp;</span> pBounds<span class="operator">(++</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span> STRING<span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span> DIGIT<span class="operator">) {</span>

												ErrorMsg<span class="operator">(</span><span class="string">" looking for string or digit for varaible decleration initilzation instead i found (%s) "</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
												continue</span><span class="operator">;
											}</span><span class="flow">

											else if</span><span class="operator">(</span>pBounds<span class="operator">(</span>i<span class="operator">) &amp;&amp; (</span>zid<span class="operator"> ==</span> VAR_INTEGER<span class="operator"> ||</span> zid<span class="operator"> ==</span> VAR_FLOAT<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> ==</span> STRING<span class="operator">) {</span>

												ErrorMsg<span class="operator">(</span><span class="string">" numeric variable decleration contains a string (%s)"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
												continue</span><span class="operator">;
											}</span><span class="flow">

											else if</span><span class="operator">(</span>pBounds<span class="operator">(</span>i<span class="operator">) &amp;&amp; (</span>zid<span class="operator"> ==</span> VAR_STRING<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> ==</span> DIGIT<span class="operator">) {</span>

												ErrorMsg<span class="operator">(</span><span class="string">" string variable decleration contains numeric values (%s)"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
												continue</span><span class="operator">;
											}
										}
									}</span><span class="flow">

									else if</span><span class="operator">(</span>GetBend<span class="operator">()-&gt;</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>name<span class="operator"> ==</span><span class="string"> ""</span><span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> ','</span><span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> ';'</span><span class="operator">) {</span>

										ErrorMsg<span class="operator">(</span><span class="string">"Error invalid variable decleration! (%s)"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
										continue</span><span class="operator">;
									}
									
								}</span><span class="flow">

								if</span><span class="operator">(</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> ==</span><span class="char"> '}'</span><span class="operator">)</span><span class="flow"> 
									continue</span><span class="operator">;</span><span class="flow">

								else</span><span class="operator"> {</span>
									ErrorMsg<span class="operator">(</span><span class="string">"(fatal) variable code block missing closing brace !"</span><span class="operator"> );</span><span class="flow">
									return</span><span class="bool"> false</span><span class="operator">;
								}
							}</span><span class="flow">

							break</span><span class="operator">;</span><span class="flow">
						case</span> TOK_EXTERN<span class="operator">:</span><span class="flow">
						case</span> TOK_BEGIN<span class="operator">:</span><span class="flow">
						case</span> TOK_END<span class="operator">:</span><span class="flow">

						case</span> TOK_PROC<span class="operator">:
							{</span>
								ID<span class="operator">++;</span><span class="flow">


								if</span><span class="operator">(</span>id<span class="operator"> ==</span> TOK_EXTERN<span class="operator"> &amp;&amp;</span> pBounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>type<span class="operator"> !=</span> IDENTIFIER<span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> ';'</span><span class="operator">) {</span>

									ErrorMsg<span class="operator">(</span><span class="string">"external function (c++) call dosent have a name, or is missing terminating semi-colon"</span><span class="operator">);</span>
									i<span class="operator">+=</span><span class="int">2</span><span class="operator">;</span><span class="flow">
									continue</span><span class="operator">;
								}</span><span class="flow">
								if</span><span class="operator">(</span>id<span class="operator"> ==</span> TOK_BEGIN<span class="operator"> &amp;&amp;</span> pBounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '{'</span><span class="operator">) {</span>

									ErrorMsg<span class="operator">(</span><span class="string">"looking for { on begin statement instead i found %s"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">

									continue</span><span class="operator">;

								}</span><span class="flow">
								
								if</span><span class="operator">(</span>id<span class="operator"> ==</span> TOK_END<span class="operator"> &amp;&amp;</span> pBounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '{'</span><span class="operator">) {</span>

									ErrorMsg<span class="operator">(</span><span class="string">"looking for { on end statement instead i found %s"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">

									continue</span><span class="operator">;

								}</span><span class="flow">

								if</span><span class="operator">(</span>id<span class="operator"> ==</span> TOK_PROC<span class="operator"> &amp;&amp;</span> pBounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">) &amp;&amp; (</span>tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '{'</span><span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> ';'</span><span class="operator">) ) {</span>

									ErrorMsg<span class="operator">(</span><span class="string">"looking for (normal) { or (extern) ; on procedure statement instead i found (%s)"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">

									continue</span><span class="operator">;
								}</span><span class="flow">

								if</span><span class="operator">(</span>id<span class="operator"> ==</span> TOK_PROC<span class="operator"> &amp;&amp;</span> pBounds<span class="operator">(++</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span> IDENTIFIER<span class="operator">) {</span>

									ErrorMsg<span class="operator">(</span><span class="string">" procedure has string or digit or symbol (%s) as a name"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
									continue</span><span class="operator">;
								}</span>

								i<span class="operator"> ++;</span><span class="flow">
								while</span><span class="operator">(</span>pBounds<span class="operator">(++</span>i<span class="operator">) &amp;&amp; (</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '}'</span><span class="operator">)) {</span><span class="type">

									int</span> prev_i<span class="operator"> =</span> i<span class="operator">;</span>
									current_line<span class="operator"> =</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>line_num<span class="operator">;</span>

									current_file<span class="operator"> =</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>source_file<span class="operator">;</span><span class="type">
									int</span> qid<span class="operator"> =</span> IdentToValue<span class="operator">(</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">);</span><span class="flow">

									if</span><span class="operator">(</span>qid<span class="operator"> == -</span><span class="int">1</span><span class="operator"> &amp;&amp;</span> id<span class="operator"> !=</span> TOK_EXTERN<span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> ==</span> IDENTIFIER<span class="operator"> &amp;&amp;</span> GetBend<span class="operator">()-&gt;</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>name<span class="operator"> ==</span><span class="string"> ""</span><span class="operator"> &amp;&amp;</span> GetBend<span class="operator">()-&gt;</span>callb<span class="operator">[</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>name<span class="operator"> ==</span><span class="string"> ""</span><span class="operator"> &amp;&amp;</span> GetBend<span class="operator">()-&gt;</span>labels<span class="operator">[</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>label_name<span class="operator"> ==</span><span class="string"> ""</span><span class="operator"> &amp;&amp;</span> GetBend<span class="operator">()-&gt;</span>Find<span class="operator">(</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">) ==</span><span class="int"> 0</span><span class="operator">) {</span>

										ErrorMsg<span class="operator">(</span><span class="string">"Invalid instruction (%s)"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
										continue</span><span class="operator">;
									}</span><span class="flow">

									if</span><span class="operator">(</span>qid<span class="operator"> &gt;=</span> TOK_MOV<span class="operator"> &amp;&amp;</span> qid<span class="operator"> &lt;=</span> TOK_PRINT<span class="operator">) {</span><span class="flow">

										if</span><span class="operator">(</span>pBounds<span class="operator">(</span>i<span class="operator">-</span><span class="int">1</span><span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">-</span><span class="int">1</span><span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> ';'</span><span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">-</span><span class="int">1</span><span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '{'</span><span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">-</span><span class="int">1</span><span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> ':'</span><span class="operator">) {</span>

											ErrorMsg<span class="operator">(</span><span class="string">" Error should have found semi-colon instead found (%s) "</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">-</span><span class="int">1</span><span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">

											continue</span><span class="operator">;
										}</span><span class="flow">
										

										switch</span><span class="operator">(</span>qid<span class="operator">) {</span><span class="flow">
										case</span> TOK_MOV<span class="operator">:</span><span class="flow"> 
										case</span> TOK_CMP<span class="operator">:</span><span class="flow">

										case</span> TOK_ADD<span class="operator">:</span><span class="flow">
										case</span> TOK_SUB<span class="operator">:</span><span class="flow">
										case</span> TOK_MUL<span class="operator">:</span><span class="flow">

										case</span> TOK_DIV<span class="operator">:</span><span class="flow">
										case</span> TOK_OR<span class="operator">:</span><span class="flow">
										case</span> TOK_XOR<span class="operator">:</span><span class="flow">

										case</span> TOK_AND<span class="operator">:
											{</span><span class="flow">

												if</span><span class="operator">(</span>pBounds<span class="operator">(++</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span> IDENTIFIER<span class="operator">) {</span>

													ErrorMsg<span class="operator">(</span><span class="string">" looking for variable name on (%s) instruction instead i found (%s)"</span><span class="operator">,</span> tok_array<span class="operator">[</span>qid<span class="operator">],</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">

													continue</span><span class="operator">;
												}</span><span class="flow">
												else if</span><span class="operator">(</span>pBounds<span class="operator">(</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> ==</span> IDENTIFIER<span class="operator"> &amp;&amp;</span> GetBend<span class="operator">()-&gt;</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>name<span class="operator"> ==</span><span class="string"> ""</span><span class="operator">) {</span>

													ErrorMsg<span class="operator">(</span><span class="string">" looking for variable name on (%s) instruction instead i found (%s)"</span><span class="operator">,</span> tok_array<span class="operator">[</span>qid<span class="operator">],</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">

													continue</span><span class="operator">;
												}</span><span class="flow">
												else if</span><span class="operator">(</span>pBounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">].</span>type<span class="operator"> ==</span> IDENTIFIER<span class="operator"> &amp;&amp;</span> GetBend<span class="operator">()-&gt;</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>name<span class="operator"> ==</span><span class="string"> ""</span><span class="operator">) {</span>

													
													ErrorMsg<span class="operator">(</span><span class="string">" expected variable or constant on (%s) instruction operand 2 instead i found (%s)"</span><span class="operator">,</span> tok_array<span class="operator">[</span>qid<span class="operator">],</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">

													continue</span><span class="operator">;

												}</span><span class="flow">
												else if</span><span class="operator">(</span>pBounds<span class="operator">(++</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> ','</span><span class="operator">) {</span>

													ErrorMsg<span class="operator">(</span><span class="string">" looking for comma to seperate (%s) instruction instead i found (%s)"</span><span class="operator">,</span> tok_array<span class="operator">[</span>qid<span class="operator">],</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">

													continue</span><span class="operator">;

												}</span><span class="flow">
												else if</span><span class="operator">(</span>pBounds<span class="operator">(++</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span> IDENTIFIER<span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span> STRING<span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span> DIGIT<span class="operator">) {</span>

													ErrorMsg<span class="operator">(</span><span class="string">" looking for variable or constant on (%s) instruction instead i found (%s)"</span><span class="operator">,</span> tok_array<span class="operator">[</span>qid<span class="operator">],</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">

													continue</span><span class="operator">;
												}
												
											}</span><span class="flow">
											break</span><span class="operator">;</span><span class="flow">
										case</span> TOK_INC<span class="operator">:</span><span class="flow">
										case</span> TOK_DEC<span class="operator">:</span><span class="flow">

										case</span> TOK_NOT<span class="operator">:</span><span class="flow">
										case</span> TOK_JMP<span class="operator">:</span><span class="flow">
										case</span> TOK_JNE<span class="operator">:</span><span class="flow">

										case</span> TOK_JE<span class="operator">:</span><span class="flow">
										case</span> TOK_JL<span class="operator">:</span><span class="flow">
										case</span> TOK_JG<span class="operator">:</span><span class="flow">

										case</span> TOK_JGE<span class="operator">:</span><span class="flow">
										case</span> TOK_JLE<span class="operator">:</span><span class="flow">
										case</span> TOK_POP<span class="operator">:
											{</span><span class="flow">

												if</span><span class="operator">((!(</span>qid<span class="operator"> &gt;=</span> TOK_JMP<span class="operator"> &amp;&amp;</span> qid<span class="operator"> &lt;=</span> TOK_JGE<span class="operator">) ||</span> qid<span class="operator"> ==</span> TOK_POP<span class="operator">) &amp;&amp;</span> pBounds<span class="operator">(++</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span> IDENTIFIER<span class="operator">) {</span>

													ErrorMsg<span class="operator">(</span><span class="string">" looking for variable name on (%s)  instead I found (%s)"</span><span class="operator"> ,</span> tok_array<span class="operator">[</span>qid<span class="operator">],</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">

													continue</span><span class="operator">;
												}</span><span class="flow">
												else if</span><span class="operator">((!(</span>qid<span class="operator"> &gt;=</span> TOK_JMP<span class="operator"> &amp;&amp;</span> qid<span class="operator"> &lt;=</span> TOK_JGE<span class="operator">) ||</span> qid<span class="operator"> ==</span> TOK_POP<span class="operator">) &amp;&amp;</span> pBounds<span class="operator">(</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> ==</span> IDENTIFIER<span class="operator"> &amp;&amp;</span> GetBend<span class="operator">()-&gt;</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>name<span class="operator"> ==</span><span class="string"> ""</span><span class="operator">) {</span>

													ErrorMsg<span class="operator">(</span><span class="string">" looking for variable name on (%s) instead I found (%s)"</span><span class="operator">,</span> tok_array<span class="operator">[</span>qid<span class="operator">],</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">

													continue</span><span class="operator">;
												}</span><span class="flow">
												else if</span><span class="operator">(</span>qid<span class="operator"> &gt;=</span> TOK_JMP<span class="operator"> &amp;&amp;</span> qid<span class="operator"> &lt;=</span> TOK_JGE<span class="operator"> &amp;&amp;</span> pBounds<span class="operator">(++</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span> IDENTIFIER<span class="operator"> ) {</span>

													ErrorMsg<span class="operator">(</span><span class="string">" looking for code label to (%s) to instead I found which might not be a valid label (%s)"</span><span class="operator">,</span> tok_array<span class="operator">[</span>qid<span class="operator">],</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">

													continue</span><span class="operator">;
												}</span><span class="flow">
												else if</span><span class="operator">(</span>qid<span class="operator"> &gt;=</span> TOK_JMP<span class="operator"> &amp;&amp;</span> qid<span class="operator"> &lt;=</span> TOK_JGE<span class="operator"> &amp;&amp;</span> pBounds<span class="operator">(</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> ==</span> IDENTIFIER<span class="operator"> &amp;&amp;</span> GetBend<span class="operator">()-&gt;</span>labels<span class="operator">[</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>label_name<span class="operator"> ==</span><span class="string"> ""</span><span class="operator">) {</span>

													ErrorMsg<span class="operator">(</span><span class="string">" couldnt find label (%s) on instruction (%s) "</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">(),</span>tok_array<span class="operator">[</span>qid<span class="operator">]);</span><span class="flow">

													continue</span><span class="operator">;
												}
												
											}</span><span class="flow">
											break</span><span class="operator">;</span><span class="flow">
										case</span> TOK_CALL<span class="operator">:
											{</span><span class="flow">
												if</span><span class="operator">(</span>pBounds<span class="operator">(++</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span> IDENTIFIER<span class="operator"> || (</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> ==</span> IDENTIFIER<span class="operator"> &amp;&amp;</span> GetBend<span class="operator">()-&gt;</span>Find<span class="operator">(</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">) ==</span><span class="int"> 0</span><span class="operator"> &amp;&amp;</span> GetBend<span class="operator">()-&gt;</span>callb<span class="operator">[</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>name<span class="operator"> ==</span><span class="string"> ""</span><span class="operator">)) {</span>

													ErrorMsg<span class="operator">(</span><span class="string">"call instruction excpets a valid procedure or external C++ function instead i found (%s)"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
													continue</span><span class="operator">;
												}

											}</span><span class="flow">

											break</span><span class="operator">;</span><span class="flow">
										case</span> TOK_PRINT<span class="operator">:</span><span class="flow">
										case</span> TOK_SCAT<span class="operator">:
											{</span><span class="flow">

												if</span><span class="operator">(</span>qid<span class="operator"> ==</span> TOK_PRINT<span class="operator"> &amp;&amp;</span> pBounds<span class="operator">(++</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> ==</span><span class="char"> '&lt;'</span><span class="operator">) {</span><span class="flow">

													if</span><span class="operator">(</span>pBounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>type<span class="operator"> ==</span><span class="char"> ';'</span><span class="operator">) {</span>

														ErrorMsg<span class="operator">(</span><span class="string">"stream terminated with semi-colon before any data was passed you put (%s)"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">

														continue</span><span class="operator">;
													}</span><span class="flow">
													while</span><span class="operator">(</span>pBounds<span class="operator">(++</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> ';'</span><span class="operator">) {</span><span class="flow">

														if</span><span class="operator">(</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span> STRING<span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span> DIGIT<span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '&lt;'</span><span class="operator"> &amp;&amp;</span> GetBend<span class="operator">()-&gt;</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>name<span class="operator"> ==</span><span class="string"> ""</span><span class="operator">) {</span>

															ErrorMsg<span class="operator">(</span><span class="string">"on print instruction requires string/digit/or stream operator you put (%s)"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
															continue</span><span class="operator">;
														}</span><span class="flow">

														else if</span><span class="operator">(</span>pBounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>type<span class="operator"> ==</span><span class="char"> '&lt;'</span><span class="operator"> &amp;&amp;</span> pBounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">].</span>type<span class="operator"> !=</span> STRING<span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">].</span>type<span class="operator"> !=</span> DIGIT<span class="operator"> &amp;&amp;</span> GetBend<span class="operator">()-&gt;</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">].</span>token<span class="operator">].</span>name<span class="operator"> ==</span><span class="string"> ""</span><span class="operator">) {</span>

															ErrorMsg<span class="operator">(</span><span class="string">" on print instruction stream operator requires r-value ( a variable on the right hand side ) of the stream operator you put (%s)"</span><span class="operator"> ,</span> tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span>

															i<span class="operator">+=</span><span class="int">2</span><span class="operator">;</span><span class="flow">
															continue</span><span class="operator">;
														}
														
													}
												}</span><span class="flow">
												else if</span><span class="operator">(</span>qid<span class="operator"> ==</span> TOK_PRINT<span class="operator"> &amp;&amp;</span> pBounds<span class="operator">(</span>i<span class="operator">) &amp;&amp; (</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span> STRING<span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span> DIGIT<span class="operator">) &amp;&amp;</span> GetBend<span class="operator">()-&gt;</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>name<span class="operator"> ==</span><span class="string"> ""</span><span class="operator">) {</span>

													ErrorMsg<span class="operator">(</span><span class="string">"print instruction requires variable/string/digit or stream operator you put (%s)"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
													continue</span><span class="operator">;
												}</span><span class="flow">

												else if</span><span class="operator">(</span>qid<span class="operator"> ==</span> TOK_SCAT<span class="operator"> &amp;&amp;</span> pBounds<span class="operator">(++</span>i<span class="operator">) &amp;&amp; (</span>GetBend<span class="operator">()-&gt;</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>name<span class="operator"> ==</span><span class="string"> ""</span><span class="operator">)) {</span>

													ErrorMsg<span class="operator">(</span><span class="string">" on scat stream , requires variable for first operand you put (%s)"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
													continue</span><span class="operator">;
												}</span><span class="flow">

												else if</span><span class="operator">(</span>qid<span class="operator"> ==</span> TOK_SCAT<span class="operator"> &amp;&amp;</span> pBounds<span class="operator">(++</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '&lt;'</span><span class="operator">) {</span>

													ErrorMsg<span class="operator">(</span><span class="string">" on scat stream, requires stream operator for second operand. you put (%s)"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
													continue</span><span class="operator">;
												}</span><span class="flow">

												else if</span><span class="operator">(</span>qid<span class="operator"> ==</span> TOK_SCAT<span class="operator"> &amp;&amp;</span> pBounds<span class="operator">(</span>i<span class="operator">)) {</span><span class="flow">
													while</span><span class="operator">(</span>pBounds<span class="operator">(++</span>i<span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> ';'</span><span class="operator">) {</span><span class="flow">

														if</span><span class="operator">(</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span> STRING<span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span> DIGIT<span class="operator"> &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '&lt;'</span><span class="operator"> &amp;&amp;</span> GetBend<span class="operator">()-&gt;</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>name<span class="operator"> ==</span><span class="string"> ""</span><span class="operator">) {</span>

															ErrorMsg<span class="operator">(</span><span class="string">"on scat stream requires string/digit/or stream operator you put (%s)"</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
															continue</span><span class="operator">;
														}
													}
												}

											}</span><span class="flow">

											break</span><span class="operator">;
										}</span><span class="flow">

										if</span><span class="operator">(</span>pBounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">) &amp;&amp;</span> tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>type<span class="operator"> ==</span><span class="char"> ';'</span><span class="operator">)</span> i<span class="operator">++;
									}</span><span class="flow">

									else if</span><span class="operator">(</span>id<span class="operator"> !=</span> TOK_EXTERN<span class="operator"> &amp;&amp;</span> qid<span class="operator"> ==</span> TOK_PROC<span class="operator"> ||</span> qid<span class="operator"> ==</span> TOK_BEGIN<span class="operator"> ||</span> qid<span class="operator"> ==</span> TOK_END<span class="operator">) {</span>

										ErrorMsg<span class="operator">(</span><span class="string">"nested procedures / blocks not allowed I found (%s) "</span><span class="operator">,</span> tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>c_str<span class="operator">());</span><span class="flow">
										continue</span><span class="operator">;
									}

								}</span><span class="flow">

								if</span><span class="operator">(</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '}'</span><span class="operator">) {</span>
									ErrorMsg<span class="operator">(</span><span class="string">" code block is missing closing brace } "</span><span class="operator">);</span><span class="flow">

									continue</span><span class="operator">;
								}

							}</span><span class="flow">
							break</span><span class="operator">;</span><span class="flow">
							
						default</span><span class="operator">:
							{


							}
						}


					}</span><span class="flow">
					break</span><span class="operator">;
					
			}
		}</span><span class="flow">
		if</span><span class="operator">(</span>err<span class="operator"> ==</span><span class="int"> 0</span><span class="operator"> &amp;&amp;</span> ID<span class="operator"> &gt;=</span><span class="int"> 4</span><span class="operator">)</span><span class="comment"> // make sure its a valid program before execution.. 
			                    //this can be disabled for speed but its not advised

</span><span class="flow">		return</span><span class="bool"> true</span><span class="operator">;</span><span class="flow">
		return</span><span class="bool"> false</span><span class="operator">;
	}</span><span class="type">

	void</span> BackEnd<span class="operator">::</span>Convert<span class="operator">() {</span><span class="flow">

		for</span><span class="operator">(</span>size_t z<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span>  z<span class="operator"> &lt;</span> p<span class="operator">-&gt;</span>insert_vec<span class="operator">.</span>size<span class="operator">();</span> z<span class="operator">++)
		{</span>

			p<span class="operator">-&gt;</span>StartParse<span class="operator">(</span>p<span class="operator">-&gt;</span>insert_vec<span class="operator">[</span>z<span class="operator">]);
		}</span><span class="flow">

		if</span><span class="operator">(!</span>p<span class="operator">-&gt;</span>insert_vec<span class="operator">.</span>empty<span class="operator">())</span> p<span class="operator">-&gt;</span>insert_vec<span class="operator">.</span>clear<span class="operator">();</span>

		std<span class="operator">::</span>string current_proc<span class="operator"> =</span><span class="string"> ""</span><span class="operator">;</span><span class="flow"> 
		for</span><span class="operator">(</span>size_t i<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> i<span class="operator"> &lt;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">.</span>size<span class="operator">();</span>i<span class="operator">++) {</span><span class="flow">

			switch</span><span class="operator">(</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator">) {</span><span class="flow">

				case</span> IDENTIFIER<span class="operator">: 
					{</span><span class="type">

						int</span> id<span class="operator"> =</span> IdentToValue<span class="operator">(</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">);</span><span class="flow">

						if</span><span class="operator">(</span>id<span class="operator"> != -</span><span class="int">1</span><span class="operator">) {</span><span class="flow">
							switch</span><span class="operator">(</span>id<span class="operator">) 
							{</span><span class="flow">
							case</span> VAR_INTEGER<span class="operator">:</span>

								i<span class="operator">++;</span><span class="flow">
								if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">)) {</span><span class="flow">
									if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">)) {</span><span class="flow">

										if</span><span class="operator">(</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">) != -</span><span class="int">1</span><span class="operator"> &amp;&amp;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>find<span class="operator">(</span><span class="char">']'</span><span class="operator">) != -</span><span class="int">1</span><span class="operator">) {</span>

											std<span class="operator">::</span>string num<span class="operator"> =</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>substr<span class="operator">(</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">)+</span><span class="int">1</span><span class="operator">,</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>find<span class="operator">(</span><span class="char">']'</span><span class="operator">)-</span><span class="int">2</span><span class="operator">);</span>

											std<span class="operator">::</span>string name<span class="operator"> =</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>substr<span class="operator">(</span><span class="int">0</span><span class="operator">,</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">));</span><span class="flow">

											for</span><span class="operator">(</span>size_t p<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> p<span class="operator"> &lt;</span> size_t<span class="operator">(</span>atoi<span class="operator">(</span>num<span class="operator">.</span>c_str<span class="operator">()));</span> p<span class="operator">++) {</span>

												std<span class="operator">::</span>ostringstream s<span class="operator">;</span>
												s<span class="operator"> &lt;&lt;</span> current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> name<span class="operator"> &lt;&lt;</span><span class="string"> "["</span><span class="operator"> &lt;&lt;</span><span class="type"> int</span><span class="operator">(</span>p<span class="operator">) &lt;&lt;</span><span class="string"> "]"</span><span class="operator">;</span>

												symbols<span class="operator">.</span>Set<span class="operator">(</span>VAR_INTEGER<span class="operator">,</span><span class="string">"0"</span><span class="operator">,</span>s<span class="operator">.</span>str<span class="operator">());
											}
										}</span><span class="flow">
										else
											if</span><span class="operator">(</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>type<span class="operator"> ==</span><span class="char"> '='</span><span class="operator">) {</span><span class="flow">

												if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">))</span> 
													symbols<span class="operator">.</span>Set<span class="operator">(</span>VAR_INTEGER<span class="operator">,</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">].</span>token<span class="operator">,</span>current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">);
											}</span><span class="flow">

											else</span><span class="operator"> {</span>
												symbols<span class="operator">.</span>Set<span class="operator">(</span>VAR_INTEGER<span class="operator">,</span><span class="string">"0"</span><span class="operator">,</span> current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">);
											}
									}
								}</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> VAR_STRING<span class="operator">:</span>
								i<span class="operator">++;</span><span class="flow">
								if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">)) {</span><span class="flow">

									if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">)) {</span><span class="flow">
										if</span><span class="operator">(</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">) != -</span><span class="int">1</span><span class="operator"> &amp;&amp;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>find<span class="operator">(</span><span class="char">']'</span><span class="operator">) != -</span><span class="int">1</span><span class="operator">) {</span>

											std<span class="operator">::</span>string num<span class="operator"> =</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>substr<span class="operator">(</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">)+</span><span class="int">1</span><span class="operator">,</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>find<span class="operator">(</span><span class="char">']'</span><span class="operator">)-</span><span class="int">2</span><span class="operator">);</span>

											std<span class="operator">::</span>string name<span class="operator"> =</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>substr<span class="operator">(</span><span class="int">0</span><span class="operator">,</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">));</span><span class="flow">

											for</span><span class="operator">(</span>size_t p<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> p<span class="operator"> &lt;</span> size_t<span class="operator">(</span>atoi<span class="operator">(</span>num<span class="operator">.</span>c_str<span class="operator">()));</span> p<span class="operator">++) {</span>

												std<span class="operator">::</span>ostringstream s<span class="operator">;</span>
												s<span class="operator"> &lt;&lt;</span> current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span>name<span class="operator"> &lt;&lt;</span><span class="string"> "["</span><span class="operator"> &lt;&lt;</span><span class="type"> int</span><span class="operator">(</span>p<span class="operator">) &lt;&lt;</span><span class="string"> "]"</span><span class="operator">;</span>

												symbols<span class="operator">.</span>Set<span class="operator">(</span>VAR_STRING<span class="operator">,</span><span class="string">""</span><span class="operator">,</span>s<span class="operator">.</span>str<span class="operator">());
											}
										}</span><span class="flow">
										else
											if</span><span class="operator">(</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>type<span class="operator"> ==</span><span class="char"> '='</span><span class="operator">) {</span><span class="flow">

												if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">))</span>
													symbols<span class="operator">.</span>Set<span class="operator">(</span>VAR_STRING<span class="operator">,</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">].</span>token<span class="operator">,</span>current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">);
											}</span><span class="flow">

											else</span><span class="operator"> {</span>
												symbols<span class="operator">.</span>Set<span class="operator">(</span>VAR_STRING<span class="operator">,</span><span class="string">""</span><span class="operator">,</span> current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">);
											}
									}
								}</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> VAR_FLOAT<span class="operator">:</span>
								i<span class="operator">++;</span><span class="flow">
								if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">)) {</span><span class="flow">

									if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">)) {</span><span class="flow">
										if</span><span class="operator">(</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">) != -</span><span class="int">1</span><span class="operator"> &amp;&amp;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>find<span class="operator">(</span><span class="char">']'</span><span class="operator">) != -</span><span class="int">1</span><span class="operator">) {</span>

											std<span class="operator">::</span>string num<span class="operator"> =</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>substr<span class="operator">(</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">)+</span><span class="int">1</span><span class="operator">,</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>find<span class="operator">(</span><span class="char">']'</span><span class="operator">)-</span><span class="int">2</span><span class="operator">);</span>

											std<span class="operator">::</span>string name<span class="operator"> =</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>substr<span class="operator">(</span><span class="int">0</span><span class="operator">,</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">.</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">));</span><span class="flow">

											for</span><span class="operator">(</span>size_t p<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> p<span class="operator"> &lt;</span> size_t<span class="operator">(</span>atoi<span class="operator">(</span>num<span class="operator">.</span>c_str<span class="operator">()));</span> p<span class="operator">++) {</span>

												std<span class="operator">::</span>ostringstream s<span class="operator">;</span>
												s<span class="operator"> &lt;&lt;</span> current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> name<span class="operator"> &lt;&lt;</span><span class="string"> "["</span><span class="operator"> &lt;&lt;</span><span class="type"> int</span><span class="operator">(</span>p<span class="operator">) &lt;&lt;</span><span class="string"> "]"</span><span class="operator">;</span>

												symbols<span class="operator">.</span>Set<span class="operator">(</span>VAR_FLOAT<span class="operator">,</span><span class="string">"0.0"</span><span class="operator">,</span>s<span class="operator">.</span>str<span class="operator">());
											}
										}</span><span class="flow">
										else if</span><span class="operator">(</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>type<span class="operator"> ==</span><span class="char"> '='</span><span class="operator">) {</span><span class="flow">

											if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">))</span>
												symbols<span class="operator">.</span>Set<span class="operator">(</span>VAR_FLOAT<span class="operator">,</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">].</span>token<span class="operator">,</span>current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">);
										}</span><span class="flow">

										else</span><span class="operator"> {</span>
											symbols<span class="operator">.</span>Set<span class="operator">(</span>VAR_FLOAT<span class="operator">,</span><span class="string">"0.0"</span><span class="operator">,</span> current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">);
										}
									}
								}</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_MAIN<span class="operator">:
								{</span>
									i<span class="operator">++;</span><span class="flow">
									if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">)) {</span>

										prog_name<span class="operator"> =</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">;</span>
										current_obj<span class="operator"> =</span><span class="string"> "master"</span><span class="operator">;</span>

										obj<span class="operator">[</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">] =</span>  p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">;
									}
								}</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_USES<span class="operator">:
								{</span>
									i<span class="operator"> +=</span><span class="int"> 2</span><span class="operator">;</span><span class="flow">

									if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">))</span><span class="flow">
										while</span><span class="operator">(</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> ';'</span><span class="operator"> &amp;&amp;</span> i<span class="operator"> &lt;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">.</span>size<span class="operator">()) {</span>

											uses<span class="operator">.</span>push_back<span class="operator">(</span>current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">);</span>

											i<span class="operator">++;</span><span class="flow">
											if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">) &amp;&amp;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator"> ==</span><span class="char"> ','</span><span class="operator">)</span>

												i<span class="operator">++;
										}
								}</span><span class="flow">
								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_MAS<span class="operator">:</span>
								i<span class="operator">++;</span><span class="flow">

								if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">)) {</span>
									current_obj<span class="operator"> =</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">;</span>

									obj<span class="operator">[</span>current_obj<span class="operator">] =</span> current_obj<span class="operator">;
								}</span><span class="flow">
								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_BEGIN<span class="operator">:</span>

								i<span class="operator"> ++;</span>
								current_proc<span class="operator"> =</span> current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span><span class="string"> "begin"</span><span class="operator">;</span><span class="flow">

								if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">))</span>
									AddIncBlock<span class="operator">(</span>current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span><span class="string"> "begin"</span><span class="operator">,</span> i<span class="operator">);</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_END<span class="operator">:</span>
								i<span class="operator"> ++;</span>
								current_proc<span class="operator"> =</span> current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span><span class="string"> "end"</span><span class="operator">;</span><span class="flow">

								if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">))</span>
									AddIncBlock<span class="operator">(</span>current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span><span class="string"> "end"</span><span class="operator">,</span> i<span class="operator">);</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_EXTERN<span class="operator">:</span>
								i<span class="operator"> +=</span><span class="int"> 2</span><span class="operator">;</span><span class="flow">

								if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">)) {</span>
									callb<span class="operator">[</span>current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>isdef<span class="operator"> =</span><span class="bool"> true</span><span class="operator">;
								}</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_PROC<span class="operator">:</span>
								i<span class="operator">++;</span>
								current_proc<span class="operator"> =</span> current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">;</span><span class="flow">

								if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">+</span><span class="int">2</span><span class="operator">)) {</span>
									AddIncBlock<span class="operator">(</span>current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">,</span> i<span class="operator">+</span><span class="int">1</span><span class="operator">);
								}</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_IMPLEMENT<span class="operator">:
								{</span>
									i<span class="operator">+=</span><span class="int">2</span><span class="operator">;</span><span class="flow">
									if</span><span class="operator">(</span>Bounds<span class="operator">(</span>i<span class="operator">)) {</span>

										callb<span class="operator">[</span>current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>imp<span class="operator"> =</span><span class="bool"> true</span><span class="operator">;</span>

										callb<span class="operator">[</span>current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>name<span class="operator"> =</span> current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">;</span>

										callb<span class="operator">[</span>current_obj<span class="operator"> +</span><span class="string"> "."</span><span class="operator"> +</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>other_name<span class="operator"> =</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">;
									}


								}</span><span class="flow">

								break</span><span class="operator">;
							}
						}
					}</span><span class="flow">
					break</span><span class="operator">;</span><span class="flow">
				case</span> STRING<span class="operator">:</span><span class="flow">
					break</span><span class="operator">;</span><span class="flow">

				case</span> DIGIT<span class="operator">:</span><span class="flow">
					break</span><span class="operator">;</span><span class="flow">
				case</span> CODELABEL<span class="operator">:</span>
					labels<span class="operator">[</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>label_name<span class="operator"> =</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">;</span>

					labels<span class="operator">[</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator">].</span>proc<span class="operator"> =</span> current_proc<span class="operator">;</span><span class="flow">

					break</span><span class="operator">;
			}
		}
	}</span><span class="type">

	void</span> BackEnd<span class="operator">::</span>AddIncBlock<span class="operator">(</span>std<span class="operator">::</span>string block_name<span class="operator">,</span> size_t start<span class="operator">) {</span>

		std<span class="operator">::</span>vector<span class="operator">&lt;</span>Instruct<span class="operator">&gt;</span> v<span class="operator">;</span>
		v<span class="operator">.</span>push_back<span class="operator"> (</span> Instruct<span class="operator">(</span><span class="int">0xFF</span><span class="operator">,</span>block_name<span class="operator">,</span><span class="string"> ""</span><span class="operator">) );</span>

		size_t pos<span class="operator">;</span><span class="flow">
		for</span><span class="operator">(</span>start<span class="operator">,</span> pos<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>start<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '}'</span><span class="operator"> &amp;&amp;</span> start<span class="operator"> &lt;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">.</span>size<span class="operator">();</span> start<span class="operator">++) {</span><span class="type">

			int</span> id<span class="operator"> =</span> IdentToValue<span class="operator">(</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>start<span class="operator">].</span>token<span class="operator">);</span><span class="flow">

			if</span><span class="operator">(</span>id<span class="operator"> &gt;=</span> TOK_MOV<span class="operator"> &amp;&amp;</span> id<span class="operator"> &lt;=</span> TOK_PRINT<span class="operator">) {</span>

				Instruct i<span class="operator">;</span>
				i<span class="operator">.</span>op_code<span class="operator"> =</span> id<span class="operator">;</span>
				i<span class="operator">.</span>op1<span class="operator"> =</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>start<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>token<span class="operator">;</span><span class="flow">

				if</span><span class="operator">(</span>Bounds<span class="operator">(</span>start<span class="operator">+</span><span class="int">3</span><span class="operator">) &amp;&amp;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>start<span class="operator">+</span><span class="int">2</span><span class="operator">].</span>type<span class="operator"> ==</span><span class="char"> ','</span><span class="operator">)</span>

					i<span class="operator">.</span>op2<span class="operator"> =</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>start<span class="operator">+</span><span class="int">3</span><span class="operator">].</span>token<span class="operator">;</span><span class="flow">

				else if</span><span class="operator">(</span>Bounds<span class="operator">(</span>start<span class="operator">+</span><span class="int">3</span><span class="operator">) &amp;&amp;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>start<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>type<span class="operator"> ==</span><span class="char"> '&lt;'</span><span class="operator">) {</span>

					std<span class="operator">::</span>ostringstream string_s<span class="operator">;</span>
					start<span class="operator">++;</span><span class="flow">
					while</span><span class="operator">(</span>Bounds<span class="operator">(</span>start<span class="operator">) &amp;&amp;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>start<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> ';'</span><span class="operator">) {</span><span class="flow">

						if</span><span class="operator">(</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>start<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '&lt;'</span><span class="operator">)</span>

							string_s<span class="operator"> &lt;&lt;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>start<span class="operator">].</span>token<span class="operator"> &lt;&lt;</span><span class="type"> char</span><span class="operator">(</span><span class="int">0xFF</span><span class="operator">);</span>

						start<span class="operator">++;
					}</span>

					i<span class="operator">.</span>op1<span class="operator"> =</span> string_s<span class="operator">.</span>str<span class="operator">();</span>

					i<span class="operator">.</span>op2<span class="operator"> =</span><span class="string"> ""</span><span class="operator">;
				}</span><span class="flow">
				else if</span><span class="operator">(</span>Bounds<span class="operator">(</span>start<span class="operator">+</span><span class="int">3</span><span class="operator">) &amp;&amp;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>start<span class="operator">+</span><span class="int">2</span><span class="operator">].</span>type<span class="operator"> ==</span><span class="char"> '&lt;'</span><span class="operator">) {</span>

					std<span class="operator">::</span>ostringstream string_s<span class="operator">;</span>
					i<span class="operator">.</span>op1<span class="operator"> =</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>start<span class="operator">+</span><span class="int">1</span><span class="operator">].</span>token<span class="operator">;</span>

					start<span class="operator">+=</span><span class="int">2</span><span class="operator">;</span><span class="flow">
					while</span><span class="operator">(</span>Bounds<span class="operator">(</span>start<span class="operator">) &amp;&amp;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>start<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> ';'</span><span class="operator">) {</span><span class="flow">

						if</span><span class="operator">(</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>start<span class="operator">].</span>type<span class="operator"> !=</span><span class="char"> '&lt;'</span><span class="operator">)</span>

							string_s<span class="operator"> &lt;&lt;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>start<span class="operator">].</span>token<span class="operator"> &lt;&lt;</span><span class="type"> char</span><span class="operator">(</span><span class="int">0xFF</span><span class="operator">);</span>

						start<span class="operator">++;
					}</span>
					i<span class="operator">.</span>op2<span class="operator"> =</span> string_s<span class="operator">.</span>str<span class="operator">();
				}</span><span class="flow">
				else</span>

					i<span class="operator">.</span>op2<span class="operator"> =</span><span class="string"> ""</span><span class="operator">;</span>
				v<span class="operator">.</span>push_back<span class="operator">(</span>i<span class="operator">);</span>

				pos<span class="operator">++;
			}</span><span class="flow">
			if</span><span class="operator">(</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>start<span class="operator">].</span>type<span class="operator"> ==</span><span class="int"> 4</span><span class="operator">) {</span>

				labels<span class="operator">[</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>start<span class="operator">].</span>token<span class="operator">].</span>pos<span class="operator"> =</span> pos<span class="operator">++;
			}
		}</span>

		ins<span class="operator">.</span>push_back<span class="operator">(</span>v<span class="operator">);
	}</span><span class="type">

	void</span> BackEnd<span class="operator">::</span>DebugInc<span class="operator">() {</span>

		size_t i<span class="operator">;</span><span class="flow">
		for</span><span class="operator">(</span>i<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> i<span class="operator"> &lt;</span> ins<span class="operator">.</span>size<span class="operator">();</span> i<span class="operator">++)</span><span class="flow">

			for</span><span class="operator">(</span>size_t z<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> z<span class="operator"> &lt;</span> ins<span class="operator">[</span>i<span class="operator">].</span>size<span class="operator">();</span> z<span class="operator">++) {</span><span class="flow">

				if</span><span class="operator">(</span>ins<span class="operator">[</span>i<span class="operator">][</span>z<span class="operator">].</span>op_code<span class="operator"> ==</span><span class="int"> 0xFF</span><span class="operator">)</span>
					cout<span class="operator"> &lt;&lt;</span><span class="string"> "Code Block Name: "</span><span class="operator"> &lt;&lt;</span> ins<span class="operator">[</span>i<span class="operator">][</span>z<span class="operator">].</span>op1<span class="operator"> &lt;&lt;</span> endl<span class="operator">;</span><span class="flow">

				else</span>
					cout<span class="operator"> &lt;&lt;</span><span class="string"> "Opcode: "</span><span class="operator"> &lt;&lt;</span> tok_array<span class="operator">[</span>ins<span class="operator">[</span>i<span class="operator">][</span>z<span class="operator">].</span>op_code<span class="operator">]  &lt;&lt;</span><span class="string"> " Operand 1: "</span><span class="operator"> &lt;&lt;</span> ins<span class="operator">[</span>i<span class="operator">][</span>z<span class="operator">].</span>op1<span class="operator"> &lt;&lt; ((</span>ins<span class="operator">[</span>i<span class="operator">][</span>z<span class="operator">].</span>op2<span class="operator">.</span>length<span class="operator">()==</span><span class="int">0</span><span class="operator">) ?</span><span class="string"> ""</span><span class="operator"> :</span><span class="string"> " Operand 2: "</span><span class="operator">) &lt;&lt;</span> ins<span class="operator">[</span>i<span class="operator">][</span>z<span class="operator">].</span>op2<span class="operator"> &lt;&lt;</span> endl<span class="operator">;
			}</span><span class="flow">

			for</span><span class="operator">(</span>i<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> i<span class="operator"> &lt;</span> uses<span class="operator">.</span>size<span class="operator">();</span> i<span class="operator">++)</span>

				cout<span class="operator"> &lt;&lt;</span><span class="string"> "Uses clause: "</span><span class="operator"> &lt;&lt;</span> uses<span class="operator">[</span>i<span class="operator">] &lt;&lt;</span> endl<span class="operator">;</span>

			std<span class="operator">::</span>map<span class="operator">&lt;</span>std<span class="operator">::</span>string<span class="operator">,</span>Code_Label<span class="operator">&gt;::</span>iterator l<span class="operator"> =</span> labels<span class="operator">.</span>begin<span class="operator">();</span><span class="flow">

			for</span><span class="operator">(</span>l<span class="operator">;</span> l<span class="operator"> !=</span> labels<span class="operator">.</span>end<span class="operator">();</span> l<span class="operator">++)</span>

				cout<span class="operator"> &lt;&lt;</span><span class="string"> "Code Label: "</span><span class="operator"> &lt;&lt;</span> l<span class="operator">-&gt;</span>second<span class="operator">.</span>label_name<span class="operator"> &lt;&lt;</span><span class="string"> " In Procedure: "</span><span class="operator"> &lt;&lt;</span> l<span class="operator">-&gt;</span>second<span class="operator">.</span>proc<span class="operator"> &lt;&lt;</span><span class="string"> " At Code Position: "</span><span class="operator"> &lt;&lt;</span><span class="type"> int</span><span class="operator">(</span>l<span class="operator">-&gt;</span>second<span class="operator">.</span>pos<span class="operator">) &lt;&lt;</span> endl<span class="operator">;

	}</span><span class="type">

	void</span> BackEnd<span class="operator">::</span>CallProcedure<span class="operator">(</span>std<span class="operator">::</span>string proc_name<span class="operator">) {</span>
		size_t p<span class="operator"> =</span> Find<span class="operator">(</span>proc_name<span class="operator">);</span><span class="flow">

		if</span><span class="operator">(</span>p<span class="operator"> !=</span><span class="int"> 0</span><span class="operator">) {</span>
			code<span class="operator">.</span>push_back<span class="operator">(</span>std<span class="operator">::</span>make_pair<span class="operator">(</span>cur_pos<span class="operator">,</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">));</span>

			cur_pos<span class="operator"> =</span> p<span class="operator">,</span> i<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span><span class="flow">
			return</span><span class="operator">;
		}</span><span class="flow">

		else</span>
			std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span><span class="string"> "**** Procedure "</span><span class="operator"> &lt;&lt;</span> proc_name<span class="operator"> &lt;&lt;</span><span class="string"> " Not Found!\n"</span><span class="operator">;

	}</span><span class="type">

	void</span> BackEnd<span class="operator">::</span>Execute<span class="operator">(</span><span class="type">bool</span> anaylize<span class="operator">) {</span><span class="flow">
		if</span><span class="operator">(</span>anaylize<span class="operator"> &amp;&amp; !</span>p<span class="operator">-&gt;</span>LexAnayalize<span class="operator">()) {</span>

			cout<span class="operator"> &lt;&lt;</span><span class="string"> "**** Errors in script cannot continue...\n"</span><span class="operator">;</span><span class="pre">
#ifdef _WIN32
</span>			system<span class="operator">(</span><span class="string">"PAUSE"</span><span class="operator">);</span><span class="pre">
#endif
</span><span class="flow">			return</span><span class="operator">;

		}</span><span class="flow">

		if</span><span class="operator">(</span>p<span class="operator">-&gt;</span>err<span class="operator"> !=</span><span class="int"> 0</span><span class="operator">) {</span>
			cout<span class="operator"> &lt;&lt;</span><span class="string"> "**** Errors in script cannot continue...\n"</span><span class="operator">;</span><span class="pre">

#ifdef _WIN32
</span>			system<span class="operator">(</span><span class="string">"PAUSE"</span><span class="operator">);</span><span class="pre">
#endif
</span><span class="flow">			return</span><span class="operator">;

		}</span><span class="flow">

		if</span><span class="operator">(!</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">.</span>empty<span class="operator">())</span>

		p<span class="operator">-&gt;</span>tok_vec<span class="operator">.</span>clear<span class="operator">();</span><span class="flow">
		if</span><span class="operator">(</span>p<span class="operator">-&gt;</span>file<span class="operator">)
		{</span>
			p<span class="operator">-&gt;</span>file<span class="operator">-&gt;</span>close<span class="operator">();
		}</span>

		size_t begin_pos<span class="operator"> =</span> Find<span class="operator">(</span><span class="string">"master.begin"</span><span class="operator">),</span> end_pos<span class="operator"> =</span> Find<span class="operator">(</span><span class="string">"master.end"</span><span class="operator">);</span>

		size_t u<span class="operator">,</span> b<span class="operator"> ,</span> e<span class="operator">;</span>
		cur_pos<span class="operator"> =</span> begin_pos<span class="operator">;</span>

		i<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span><span class="flow">

		if</span><span class="operator">(</span>end_pos<span class="operator"> !=</span><span class="int"> 0</span><span class="operator">)</span>

			code<span class="operator">.</span>push_back<span class="operator">(</span> std<span class="operator">::</span>pair<span class="operator">&lt;</span>size_t<span class="operator">,</span>size_t<span class="operator">&gt;(</span>end_pos<span class="operator">,</span><span class="int">0</span><span class="operator">) );</span><span class="flow">

		if</span><span class="operator">(</span>uses<span class="operator">.</span>size<span class="operator">()!=</span><span class="int">0</span><span class="operator">) {</span><span class="flow">
		for</span><span class="operator">(</span>u<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> u<span class="operator"> &lt;</span> uses<span class="operator">.</span>size<span class="operator">();</span> u<span class="operator">++) {</span>

			std<span class="operator">::</span>string str<span class="operator"> =</span> uses<span class="operator">[</span>u<span class="operator">].</span>substr<span class="operator">(</span>uses<span class="operator">[</span>u<span class="operator">].</span>find<span class="operator">(</span><span class="string">"."</span><span class="operator">)+</span><span class="int">1</span><span class="operator">,</span>uses<span class="operator">[</span>u<span class="operator">].</span>length<span class="operator">());</span>

			e<span class="operator"> =</span> Find<span class="operator">(</span>str<span class="operator"> +</span><span class="string"> ".end"</span><span class="operator">);</span><span class="flow">
			if</span><span class="operator">(</span>e<span class="operator"> !=</span><span class="int"> 0</span><span class="operator">)</span> 
				code<span class="operator">.</span>push_back<span class="operator">(</span>std<span class="operator">::</span>make_pair<span class="operator">(</span>e<span class="operator">,</span><span class="int">0</span><span class="operator">));
		}</span>

		code<span class="operator">.</span>push_back<span class="operator">(</span>std<span class="operator">::</span>make_pair<span class="operator">(</span>begin_pos<span class="operator">,</span><span class="int">0</span><span class="operator">));</span><span class="flow">
		for</span><span class="operator">(</span>u<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> u<span class="operator"> &lt;</span> uses<span class="operator">.</span>size<span class="operator">();</span> u<span class="operator">++) {</span>

			std<span class="operator">::</span>string str<span class="operator"> =</span> uses<span class="operator">[</span>u<span class="operator">].</span>substr<span class="operator">(</span>uses<span class="operator">[</span>u<span class="operator">].</span>find<span class="operator">(</span><span class="string">"."</span><span class="operator">)+</span><span class="int">1</span><span class="operator">,</span>uses<span class="operator">[</span>u<span class="operator">].</span>length<span class="operator">());</span>

			b<span class="operator"> =</span> Find<span class="operator">(</span>str<span class="operator"> +</span><span class="string"> ".begin"</span><span class="operator">);</span><span class="flow">
			if</span><span class="operator">(</span>u<span class="operator"> !=</span> uses<span class="operator">.</span>size<span class="operator">()-</span><span class="int">1</span><span class="operator">)</span>

				code<span class="operator">.</span>push_back<span class="operator">(</span>std<span class="operator">::</span>make_pair<span class="operator">(</span>b<span class="operator">,</span><span class="int">0</span><span class="operator">));
		}</span>
		cur_pos<span class="operator"> =</span> b<span class="operator">;
		}</span><span class="flow">

		else</span>
			cur_pos<span class="operator"> =</span> begin_pos<span class="operator">;</span><span class="flow">
		
		while</span><span class="operator">(</span><span class="int">1</span><span class="operator">) {</span><span class="flow">

			while</span><span class="operator">(</span>i<span class="operator"> &lt;</span> ins<span class="operator">[</span>cur_pos<span class="operator">].</span>size<span class="operator">()) {</span>
				PROC_RETURN rt<span class="operator">;</span><span class="flow">

				if</span><span class="operator">((</span>rt<span class="operator"> =</span> ProcInc<span class="operator">(</span>cur_pos<span class="operator">,</span> i<span class="operator">)) ==</span> PROC_CONT<span class="operator">)</span>

					ins<span class="operator">[</span>cur_pos<span class="operator">][</span>i<span class="operator">].</span>op1<span class="operator"> =</span> prev_op1<span class="operator">,</span> ins<span class="operator">[</span>cur_pos<span class="operator">][</span>i<span class="operator">].</span>op2<span class="operator"> =</span> prev_op2<span class="operator">,</span> i<span class="operator">++;</span><span class="flow">

				else if</span><span class="operator">(</span>rt<span class="operator"> ==</span> PROC_JMP<span class="operator">){</span>
					ins<span class="operator">[</span>cur_pos<span class="operator">][</span>i<span class="operator">].</span>op1<span class="operator"> =</span> prev_op1<span class="operator">,</span> ins<span class="operator">[</span>cur_pos<span class="operator">][</span>i<span class="operator">].</span>op2<span class="operator"> =</span> prev_op2<span class="operator">;</span>

					size_t pos<span class="operator"> =</span> Find<span class="operator">(</span>ins<span class="operator">[</span>cur_pos<span class="operator">][</span>i<span class="operator">].</span>op1<span class="operator">);</span><span class="flow">
					if</span><span class="operator">(</span>pos<span class="operator"> !=</span><span class="int"> 0</span><span class="operator">) {</span><span class="flow">

						if</span><span class="operator">(</span>ins<span class="operator">[</span>pos<span class="operator">][</span><span class="int">0</span><span class="operator">].</span>op_code<span class="operator"> ==</span><span class="int"> 0xFF</span><span class="operator">) {</span>
							code<span class="operator">.</span>push_back<span class="operator">(</span>std<span class="operator">::</span>pair<span class="operator">&lt;</span>size_t<span class="operator">,</span>size_t<span class="operator">&gt;(</span>cur_pos<span class="operator">,</span>i<span class="operator">+</span><span class="int">1</span><span class="operator">));</span>

							code<span class="operator">.</span>push_back<span class="operator">(</span>std<span class="operator">::</span>pair<span class="operator">&lt;</span>size_t<span class="operator">,</span>size_t<span class="operator">&gt;(</span>pos<span class="operator">,</span><span class="int">0</span><span class="operator">));</span><span class="flow">

							break</span><span class="operator">;
						}
					}</span><span class="flow">
					else</span><span class="operator">
					{</span><span class="flow">
						if</span><span class="operator">(</span>callb<span class="operator">[</span>ins<span class="operator">[</span>cur_pos<span class="operator">][</span>i<span class="operator">].</span>op1<span class="operator">].</span>name<span class="operator"> ==</span><span class="string"> ""</span><span class="operator"> ||</span> callb<span class="operator">[</span>ins<span class="operator">[</span>cur_pos<span class="operator">][</span>i<span class="operator">].</span>op1<span class="operator">].</span>isdef<span class="operator"> ==</span><span class="bool"> false</span><span class="operator">)</span>

							cout<span class="operator"> &lt;&lt;</span><span class="string"> "**** invalid procedure call-&gt; "</span><span class="operator"> &lt;&lt;</span> ins<span class="operator">[</span>cur_pos<span class="operator">][</span>i<span class="operator">].</span>op1<span class="operator"> &lt;&lt;</span> endl<span class="operator">;</span><span class="flow">

						else
							if</span><span class="operator">(</span>callb<span class="operator">[</span>ins<span class="operator">[</span>cur_pos<span class="operator">][</span>i<span class="operator">].</span>op1<span class="operator">].</span>f<span class="operator">(</span>symbols<span class="operator">) !=</span><span class="int"> 0</span><span class="operator">)</span>

								std<span class="operator">::</span>cerr<span class="operator"> &lt;&lt;</span><span class="string"> "Error external callback didnt return 0\n"</span><span class="operator">;</span>
						i<span class="operator">++;
					}
				}</span><span class="flow">
				else if</span><span class="operator">(</span>rt<span class="operator"> ==</span> PROC_RET<span class="operator">) {</span>

					ins<span class="operator">[</span>cur_pos<span class="operator">][</span>i<span class="operator">].</span>op1<span class="operator"> =</span> prev_op1<span class="operator">,</span> ins<span class="operator">[</span>cur_pos<span class="operator">][</span>i<span class="operator">].</span>op2<span class="operator"> =</span> prev_op2<span class="operator">;</span><span class="flow">

					break</span><span class="operator">;
				}
			}</span><span class="flow">

			if</span><span class="operator">(</span>code<span class="operator">.</span>empty<span class="operator">())</span><span class="flow">
				break</span><span class="operator">;</span>

			cur_pos<span class="operator"> =</span> code<span class="operator">.</span>back<span class="operator">().</span>first<span class="operator">;</span>
			i<span class="operator"> =</span> code<span class="operator">.</span>back<span class="operator">().</span>second<span class="operator">;</span>

			code<span class="operator">.</span>pop_back<span class="operator">();
		}
	}</span>

	PROC_RETURN BackEnd<span class="operator">::</span>ProcInc<span class="operator">(</span>size_t block<span class="operator">,</span> size_t<span class="operator"> &amp;</span>inc<span class="operator">) {</span>

		prev_op1<span class="operator"> =</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">;</span>
		prev_op2<span class="operator"> =</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">;</span><span class="flow">

		if</span><span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">.</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">) != -</span><span class="int">1</span><span class="operator"> &amp;&amp;</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">.</span>find<span class="operator">(</span><span class="char">']'</span><span class="operator">) != -</span><span class="int">1</span><span class="operator">) {</span>

			std<span class="operator">::</span>ostringstream curs<span class="operator">;</span>
			std<span class="operator">::</span>string num<span class="operator"> =</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">;</span>

			std<span class="operator">::</span>vector<span class="operator">&lt;</span>std<span class="operator">::</span>string<span class="operator">&gt;</span> vec<span class="operator">;</span><span class="flow">
			while</span><span class="operator">(</span>num<span class="operator">.</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">) != -</span><span class="int">1</span><span class="operator">) {</span>

				num<span class="operator"> =</span> num<span class="operator">.</span>substr<span class="operator">(</span>num<span class="operator">.</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">)+</span><span class="int">1</span><span class="operator">,</span>num<span class="operator">.</span>length<span class="operator">());</span>

				num<span class="operator"> =</span> num<span class="operator">.</span>substr<span class="operator">(</span><span class="int">0</span><span class="operator">,</span>num<span class="operator">.</span>rfind<span class="operator">(</span><span class="char">']'</span><span class="operator">));</span>

				vec<span class="operator">.</span>push_back<span class="operator">(</span>num<span class="operator">);
			}</span>

			std<span class="operator">::</span>string prev_index<span class="operator"> =</span><span class="string"> ""</span><span class="operator">;</span><span class="flow">

			for</span><span class="operator">(</span><span class="type">int</span> array_pos<span class="operator"> =</span><span class="type"> int</span><span class="operator">(</span>vec<span class="operator">.</span>size<span class="operator">())-</span><span class="int">1</span><span class="operator">;</span> array_pos<span class="operator"> &gt;=</span><span class="int"> 0</span><span class="operator">;</span> array_pos<span class="operator">--) {</span>

				std<span class="operator">::</span>string  the_name<span class="operator"> =</span><span class="string"> ""</span><span class="operator">;</span><span class="flow">
				if</span><span class="operator">(</span>vec<span class="operator">[</span>array_pos<span class="operator">].</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">) != -</span><span class="int">1</span><span class="operator">) {</span><span class="flow">

					if</span><span class="operator">(</span>IsVar<span class="operator">(</span>vec<span class="operator">[</span>array_pos<span class="operator">])) {</span>
						prev_index<span class="operator"> =</span> symbols<span class="operator">.</span>vars<span class="operator">[</span>vec<span class="operator">[</span>array_pos<span class="operator">]].</span>val<span class="operator">;
					}</span><span class="flow">

					else</span><span class="operator"> {</span>
						the_name<span class="operator"> =</span> vec<span class="operator">[</span>array_pos<span class="operator">].</span>substr<span class="operator">(</span><span class="int">0</span><span class="operator">,</span>vec<span class="operator">[</span>array_pos<span class="operator">].</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">));</span>

						prev_index<span class="operator"> =</span> symbols<span class="operator">.</span>vars<span class="operator">[</span>the_name<span class="operator"> +</span><span class="string"> "["</span><span class="operator"> +</span> prev_index<span class="operator"> +</span><span class="string"> "]"</span><span class="operator">].</span>val<span class="operator">;
					}
				}</span><span class="flow">

				else</span>
					prev_index<span class="operator"> = (</span>IsVar<span class="operator">(</span>vec<span class="operator">[</span>array_pos<span class="operator">]) ==</span><span class="bool"> true</span><span class="operator"> ?</span> symbols<span class="operator">.</span>vars<span class="operator">[</span>vec<span class="operator">[</span>array_pos<span class="operator">]].</span>val<span class="operator"> :</span> vec<span class="operator">[</span>array_pos<span class="operator">]);
			}</span>

			std<span class="operator">::</span>string name<span class="operator"> =</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">.</span>substr<span class="operator">(</span><span class="int">0</span><span class="operator">,</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">.</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">));</span>

			curs<span class="operator"> &lt;&lt;</span> name<span class="operator"> &lt;&lt;</span><span class="string"> "["</span><span class="operator"> &lt;&lt;</span> prev_index<span class="operator"> &lt;&lt;</span><span class="string"> "]"</span><span class="operator">;</span>
			ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator"> =</span> curs<span class="operator">.</span>str<span class="operator">();
		}</span><span class="flow">

		if</span><span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">) != -</span><span class="int">1</span><span class="operator"> &amp;&amp;</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>find<span class="operator">(</span><span class="char">']'</span><span class="operator">) != -</span><span class="int">1</span><span class="operator">) {</span>

			std<span class="operator">::</span>ostringstream curs<span class="operator">;</span>
			std<span class="operator">::</span>string num<span class="operator"> =</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">;</span>

			std<span class="operator">::</span>vector<span class="operator">&lt;</span>std<span class="operator">::</span>string<span class="operator">&gt;</span> vec<span class="operator">;</span><span class="flow">
			while</span><span class="operator">(</span>num<span class="operator">.</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">) != -</span><span class="int">1</span><span class="operator">) {</span>

				num<span class="operator"> =</span> num<span class="operator">.</span>substr<span class="operator">(</span>num<span class="operator">.</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">)+</span><span class="int">1</span><span class="operator">,</span>num<span class="operator">.</span>length<span class="operator">());</span>

				num<span class="operator"> =</span> num<span class="operator">.</span>substr<span class="operator">(</span><span class="int">0</span><span class="operator">,</span>num<span class="operator">.</span>rfind<span class="operator">(</span><span class="char">']'</span><span class="operator">));</span>

				vec<span class="operator">.</span>push_back<span class="operator">(</span>num<span class="operator">);
			}</span>
			std<span class="operator">::</span>string prev_index<span class="operator"> =</span><span class="string"> ""</span><span class="operator">;</span><span class="flow">

			for</span><span class="operator">(</span><span class="type">int</span> array_pos<span class="operator"> =</span><span class="type"> int</span><span class="operator">(</span>vec<span class="operator">.</span>size<span class="operator">())-</span><span class="int">1</span><span class="operator">;</span> array_pos<span class="operator"> &gt;=</span><span class="int"> 0</span><span class="operator">;</span> array_pos<span class="operator">--) {</span>

				std<span class="operator">::</span>string  the_name<span class="operator">;</span><span class="flow">
				if</span><span class="operator">(</span>vec<span class="operator">[</span>array_pos<span class="operator">].</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">) != -</span><span class="int">1</span><span class="operator">) {</span><span class="flow">

					if</span><span class="operator">(</span>IsVar<span class="operator">(</span>vec<span class="operator">[</span>array_pos<span class="operator">])) {</span>
						prev_index<span class="operator"> =</span> symbols<span class="operator">.</span>vars<span class="operator">[</span>vec<span class="operator">[</span>array_pos<span class="operator">]].</span>val<span class="operator">;
					}</span><span class="flow">

					else</span><span class="operator"> {</span>
						the_name<span class="operator"> =</span> vec<span class="operator">[</span>array_pos<span class="operator">].</span>substr<span class="operator">(</span><span class="int">0</span><span class="operator">,</span>vec<span class="operator">[</span>array_pos<span class="operator">].</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">));</span>

						prev_index<span class="operator"> =</span> symbols<span class="operator">.</span>vars<span class="operator">[</span>the_name<span class="operator"> +</span><span class="string"> "["</span><span class="operator"> +</span> prev_index<span class="operator"> +</span><span class="string"> "]"</span><span class="operator">].</span>val<span class="operator">;
					}
				}</span><span class="flow">

				else</span>
					prev_index<span class="operator"> = (</span>IsVar<span class="operator">(</span>vec<span class="operator">[</span>array_pos<span class="operator">]) ==</span><span class="bool"> true</span><span class="operator"> ?</span> symbols<span class="operator">.</span>vars<span class="operator">[</span>vec<span class="operator">[</span>array_pos<span class="operator">]].</span>val<span class="operator"> :</span> vec<span class="operator">[</span>array_pos<span class="operator">]);
			}</span>

			std<span class="operator">::</span>string name<span class="operator"> =</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>substr<span class="operator">(</span><span class="int">0</span><span class="operator">,</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>find<span class="operator">(</span><span class="char">'['</span><span class="operator">));</span>

			curs<span class="operator"> &lt;&lt;</span> name<span class="operator"> &lt;&lt;</span><span class="string"> "["</span><span class="operator"> &lt;&lt;</span> prev_index<span class="operator"> &lt;&lt;</span><span class="string"> "]"</span><span class="operator">;</span>
			ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator"> =</span> curs<span class="operator">.</span>str<span class="operator">();
		}</span><span class="flow">

		switch</span><span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op_code<span class="operator">) {</span><span class="flow">
			case</span> TOK_MOV<span class="operator">:</span><span class="flow">

				if</span><span class="operator">(</span>IsVar<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">)) {</span><span class="flow">
					if</span><span class="operator">(</span>IsVar<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">))</span>

						symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator"> =</span> symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">].</span>val<span class="operator">;</span><span class="flow">

					else</span>
						symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator"> =</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">;
				}</span><span class="flow">

				else</span>
					std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span><span class="string"> "**** invalid variable name on mov...["</span><span class="operator"> &lt;&lt;</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator"> &lt;&lt;</span><span class="string"> "]\n"</span><span class="operator">;</span><span class="flow">

				break</span><span class="operator">;</span><span class="flow">
			case</span> TOK_ADD<span class="operator">:</span><span class="flow">
			case</span> TOK_SUB<span class="operator">:</span><span class="flow">
			case</span> TOK_MUL<span class="operator">:</span><span class="flow">

			case</span> TOK_DIV<span class="operator">:</span><span class="flow">
			case</span> TOK_OR<span class="operator">:</span><span class="flow">
			case</span> TOK_XOR<span class="operator">:</span><span class="flow">

			case</span> TOK_AND<span class="operator">:
				{</span><span class="flow">
					if</span><span class="operator">(</span>IsVar<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">)) {</span><span class="flow">

						if</span><span class="operator">(</span>IsVar<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">))
						{</span>
							std<span class="operator">::</span>ostringstream s<span class="operator">;</span><span class="flow">

							switch</span><span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op_code<span class="operator">) 
							{</span><span class="flow">
							case</span> TOK_ADD<span class="operator">:</span>

								s<span class="operator"> &lt;&lt; (</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>type<span class="operator"> ==</span> VAR_INTEGER<span class="operator"> ? (</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())+</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())) : (</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())+</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())));</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_SUB<span class="operator">:</span>
								s<span class="operator"> &lt;&lt; (</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>type<span class="operator"> ==</span> VAR_INTEGER<span class="operator"> ? (</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())-</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())) : (</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())-</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())));</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_MUL<span class="operator">:</span>
								s<span class="operator"> &lt;&lt; (</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>type<span class="operator"> ==</span> VAR_INTEGER<span class="operator"> ? (</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())*</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())) : (</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())*</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())));</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_DIV<span class="operator">:</span><span class="flow">
								if</span><span class="operator">(</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">()) ==</span><span class="int"> 0</span><span class="operator"> ||</span> std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">()) ==</span><span class="int"> 0</span><span class="operator">)</span>

									std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span><span class="string"> "***** Error cannot divide by zero...\n"</span><span class="operator">;</span><span class="flow">
								else</span>
									s<span class="operator"> &lt;&lt; (</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>type<span class="operator"> ==</span> VAR_INTEGER<span class="operator"> ? (</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())/</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())) : (</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())/</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())));</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_OR<span class="operator">:</span>
								s<span class="operator"> &lt;&lt; (</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())|</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">()));</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_XOR<span class="operator">:</span>
								s<span class="operator"> &lt;&lt; (</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())^</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">()));</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_AND<span class="operator">:</span>
								s<span class="operator"> &lt;&lt; (</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())&amp;</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">()));</span><span class="flow">

								break</span><span class="operator">;
							}</span>
							symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator"> =</span> s<span class="operator">.</span>str<span class="operator">();
						}</span><span class="flow">

						else</span><span class="operator">
						{</span>
							std<span class="operator">::</span>ostringstream s<span class="operator">;</span><span class="flow">
							switch</span><span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op_code<span class="operator">) 
							{</span><span class="flow">

							case</span> TOK_ADD<span class="operator">:</span>
								s<span class="operator"> &lt;&lt; (</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>type<span class="operator"> ==</span> VAR_INTEGER<span class="operator"> ? (</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())+</span>std<span class="operator">::</span>atoi<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>c_str<span class="operator">())) : (</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())+</span>atof<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>c_str<span class="operator">())));</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_SUB<span class="operator">:</span>
								s<span class="operator"> &lt;&lt; (</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>type<span class="operator"> ==</span> VAR_INTEGER<span class="operator"> ? (</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())-</span>std<span class="operator">::</span>atoi<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>c_str<span class="operator">())) : (</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())-</span>atof<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>c_str<span class="operator">())));</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_MUL<span class="operator">:</span>
								s<span class="operator"> &lt;&lt; (</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>type<span class="operator"> ==</span> VAR_INTEGER<span class="operator"> ? (</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())*</span>std<span class="operator">::</span>atoi<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>c_str<span class="operator">())) : (</span>std<span class="operator">::</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())*</span>std<span class="operator">::</span>atof<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>c_str<span class="operator">())));</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_DIV<span class="operator">:</span><span class="flow">
								if</span><span class="operator">(</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">()) ==</span><span class="int"> 0</span><span class="operator"> ||</span> std<span class="operator">::</span>atoi<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>c_str<span class="operator">()) ==</span><span class="int"> 0</span><span class="operator">)</span>

									cout<span class="operator"> &lt;&lt;</span><span class="string"> "***** Error cannot divide by zero...\n"</span><span class="operator">;</span><span class="flow">
								else</span>
									s<span class="operator"> &lt;&lt; (</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>type<span class="operator"> ==</span> VAR_INTEGER<span class="operator"> ? (</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())/</span>std<span class="operator">::</span>atoi<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>c_str<span class="operator">())) : (</span>std<span class="operator">::</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())/</span>std<span class="operator">::</span>atof<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>c_str<span class="operator">())));</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_OR<span class="operator">:</span>
								s<span class="operator"> &lt;&lt; (</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())|</span>std<span class="operator">::</span>atoi<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>c_str<span class="operator">()));</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_XOR<span class="operator">:</span>
								s<span class="operator"> &lt;&lt; (</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())^</span>std<span class="operator">::</span>atoi<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>c_str<span class="operator">()));</span><span class="flow">

								break</span><span class="operator">;</span><span class="flow">
							case</span> TOK_AND<span class="operator">:</span>
								s<span class="operator"> &lt;&lt; (</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())&amp;</span>std<span class="operator">::</span>atoi<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>c_str<span class="operator">()));</span><span class="flow">

								break</span><span class="operator">;
							}</span>
							symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator"> =</span> s<span class="operator">.</span>str<span class="operator">();
						}
					}</span><span class="flow">

					else</span>
						std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span><span class="string"> "**** invalid variable name ...["</span><span class="operator"> &lt;&lt;</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator"> &lt;&lt;</span><span class="string"> "]\n"</span><span class="operator">;
				}</span><span class="flow">

				break</span><span class="operator">;</span><span class="flow">
			case</span> TOK_NOT<span class="operator">:
				{</span><span class="flow">
					if</span><span class="operator">(</span>IsVar<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">)) {</span>

						std<span class="operator">::</span>ostringstream s<span class="operator">;</span>
						s<span class="operator"> &lt;&lt; (!</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">()));</span>

						symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator"> =</span> s<span class="operator">.</span>str<span class="operator">();
					}</span><span class="flow">

					else</span>
						std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span><span class="string"> "**** invalid variable name ...["</span><span class="operator"> &lt;&lt;</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator"> &lt;&lt;</span><span class="string"> "]\n"</span><span class="operator">;
				}</span><span class="flow">

				break</span><span class="operator">;</span><span class="flow">
			case</span> TOK_INC<span class="operator">:</span><span class="flow">
			case</span> TOK_DEC<span class="operator">:
				{</span><span class="flow">
					if</span><span class="operator">(</span>IsVar<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">)) {</span>

						std<span class="operator">::</span>ostringstream s<span class="operator">;</span><span class="flow">
						if</span><span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op_code<span class="operator"> ==</span> TOK_INC<span class="operator">)</span>

							s<span class="operator"> &lt;&lt; (</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())+</span><span class="int">1</span><span class="operator">);</span><span class="flow">

						else</span>
							s<span class="operator"> &lt;&lt; (</span>std<span class="operator">::</span>atoi<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">())-</span><span class="int">1</span><span class="operator">);</span>

						symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator"> =</span> s<span class="operator">.</span>str<span class="operator">();
					}</span><span class="flow">

					else</span>
						std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span><span class="string"> "**** invalid variable name ...["</span><span class="operator"> &lt;&lt;</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator"> &lt;&lt;</span><span class="string"> "]\n"</span><span class="operator">;
				}</span><span class="flow">

				break</span><span class="operator">;</span><span class="flow">
			case</span> TOK_PUSH<span class="operator">: 
				{</span><span class="keyword">
					static</span> symb s<span class="operator">;</span><span class="flow">

					if</span><span class="operator">(</span>IsVar<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">)) {</span>
						s<span class="operator">.</span>name<span class="operator"> =</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">;</span>

						s<span class="operator">.</span>val<span class="operator"> =</span> symbols<span class="operator">.</span>vars<span class="operator">[</span>s<span class="operator">.</span>name<span class="operator">].</span>val<span class="operator">;</span>

						s<span class="operator">.</span>type<span class="operator"> =</span> symbols<span class="operator">.</span>vars<span class="operator">[</span>s<span class="operator">.</span>name<span class="operator">].</span>type<span class="operator">;</span>

						symbols<span class="operator"> +=</span> s<span class="operator">;
					}</span><span class="flow">
					else</span><span class="operator">
					{</span>
						s<span class="operator">.</span>name<span class="operator"> =</span><span class="string"> "constant"</span><span class="operator">;</span>

						s<span class="operator">.</span>type<span class="operator"> =</span> IDENTIFIER<span class="operator">;</span>
						s<span class="operator">.</span>val<span class="operator"> =</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">;</span>

						symbols<span class="operator"> +=</span> s<span class="operator">;
					}
				}</span><span class="flow">
				break</span><span class="operator">;</span><span class="flow">
			case</span> TOK_POP<span class="operator">:
				{</span><span class="flow">

					if</span><span class="operator">(</span>IsVar<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">))
					{</span>
						symb s<span class="operator"> = --</span>symbols<span class="operator">;</span>

						symbols<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator"> =</span> s<span class="operator">.</span>val<span class="operator">;
					}</span><span class="flow">

					else</span>
						std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span><span class="string"> "**** invalid variable name on pop...["</span><span class="operator"> &lt;&lt;</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator"> &lt;&lt;</span><span class="string"> "]\n"</span><span class="operator">;
				}</span><span class="flow">

				break</span><span class="operator">;</span><span class="flow">
			case</span> TOK_PRINT<span class="operator">:</span><span class="flow">
				if</span><span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">.</span>find<span class="operator">(</span><span class="type">char</span><span class="operator">(</span><span class="int">0xFF</span><span class="operator">)) == -</span><span class="int">1</span><span class="operator"> &amp;&amp;</span> symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>name<span class="operator"> !=</span><span class="string"> ""</span><span class="operator">)</span>

					std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span> symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">;</span><span class="flow">

				else if</span><span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">.</span>find<span class="operator">(</span><span class="type">char</span><span class="operator">(</span><span class="int">0xFF</span><span class="operator">)) == -</span><span class="int">1</span><span class="operator">) {</span>

					std<span class="operator">::</span>cout<span class="operator">&lt;&lt;</span>  ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">;
				}</span><span class="flow">
				else</span><span class="operator"> {</span><span class="comment"> // stream data

</span>					std<span class="operator">::</span>ostringstream string_s<span class="operator">;</span>
					std<span class="operator">::</span>string left<span class="operator">,</span> right<span class="operator">,</span>temp<span class="operator"> =</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">;</span><span class="flow">

					while</span><span class="operator">(</span>temp<span class="operator">.</span>length<span class="operator">() &gt;</span><span class="int"> 0</span><span class="operator"> &amp;&amp;</span> temp<span class="operator">.</span>find<span class="operator">(</span><span class="type">char</span><span class="operator">(</span><span class="int">0xFF</span><span class="operator">)) != -</span><span class="int">1</span><span class="operator">) {</span>

						left<span class="operator"> =</span> temp<span class="operator">.</span>substr<span class="operator">(</span><span class="int">0</span><span class="operator">,</span>temp<span class="operator">.</span>find<span class="operator">(</span><span class="type">char</span><span class="operator">(</span><span class="int">0xFF</span><span class="operator">)));</span>

						temp<span class="operator"> =</span> temp<span class="operator">.</span>substr<span class="operator">(</span>temp<span class="operator">.</span>find<span class="operator">(</span><span class="type">char</span><span class="operator">(</span><span class="int">0xFF</span><span class="operator">))+</span><span class="int">1</span><span class="operator">,</span>temp<span class="operator">.</span>length<span class="operator">());</span><span class="flow">

						if</span><span class="operator">(</span>IsVar<span class="operator">(</span>left<span class="operator">))</span> 
							string_s<span class="operator"> &lt;&lt;</span> symbols<span class="operator">.</span>vars<span class="operator">[</span>left<span class="operator">].</span>val<span class="operator">;</span><span class="flow">

						else</span>
							string_s<span class="operator"> &lt;&lt;</span> left<span class="operator">;
					}</span>

					cout<span class="operator"> &lt;&lt;</span> string_s<span class="operator">.</span>str<span class="operator">();
				}</span><span class="flow">

				break</span><span class="operator">;</span><span class="flow">
			case</span> TOK_SCAT<span class="operator">:
				{</span>
					std<span class="operator">::</span>ostringstream string_s<span class="operator">;</span><span class="flow">
					if</span><span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>find<span class="operator">(</span><span class="type">char</span><span class="operator">(</span><span class="int">0xFF</span><span class="operator">)) == -</span><span class="int">1</span><span class="operator"> &amp;&amp;</span> symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>name<span class="operator"> !=</span><span class="string"> ""</span><span class="operator">) {</span>

						std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span><span class="string"> "**** error no data to stream to variable...\n"</span><span class="operator">;
					}</span><span class="flow">
					else</span><span class="operator"> {</span><span class="comment"> // stream data
</span>						std<span class="operator">::</span>string left<span class="operator">,</span> right<span class="operator">,</span>temp<span class="operator"> =</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">;</span><span class="flow">

						while</span><span class="operator">(</span>temp<span class="operator">.</span>length<span class="operator">() &gt;</span><span class="int"> 0</span><span class="operator"> &amp;&amp;</span> temp<span class="operator">.</span>find<span class="operator">(</span><span class="type">char</span><span class="operator">(</span><span class="int">0xFF</span><span class="operator">)) != -</span><span class="int">1</span><span class="operator">) {</span>

							left<span class="operator"> =</span> temp<span class="operator">.</span>substr<span class="operator">(</span><span class="int">0</span><span class="operator">,</span>temp<span class="operator">.</span>find<span class="operator">(</span><span class="type">char</span><span class="operator">(</span><span class="int">0xFF</span><span class="operator">)));</span>

							temp<span class="operator"> =</span> temp<span class="operator">.</span>substr<span class="operator">(</span>temp<span class="operator">.</span>find<span class="operator">(</span><span class="type">char</span><span class="operator">(</span><span class="int">0xFF</span><span class="operator">))+</span><span class="int">1</span><span class="operator">,</span>temp<span class="operator">.</span>length<span class="operator">());</span><span class="flow">

							if</span><span class="operator">(</span>IsVar<span class="operator">(</span>left<span class="operator">))</span> 
								string_s<span class="operator"> &lt;&lt;</span> symbols<span class="operator">.</span>vars<span class="operator">[</span>left<span class="operator">].</span>val<span class="operator">;</span><span class="flow">

							else</span>
								string_s<span class="operator"> &lt;&lt;</span> left<span class="operator">;
						}</span>

						symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator"> =</span> string_s<span class="operator">.</span>str<span class="operator">();
					}
				}</span><span class="flow">

				break</span><span class="operator">;</span><span class="flow">
			case</span> TOK_CALL<span class="operator">:</span><span class="flow">
				return</span> PROC_JMP<span class="operator">;</span><span class="flow">
				break</span><span class="operator">;</span><span class="flow">

			case</span> TOK_JMP<span class="operator">:</span><span class="flow">
				if</span><span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span><span class="int">0</span><span class="operator">].</span>op1<span class="operator"> ==</span> labels<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>proc<span class="operator">)</span>

					inc<span class="operator"> =</span> labels<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>pos<span class="operator">;</span><span class="flow">

				else</span>
					std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span><span class="string"> "***** on jmp instruction wrong procedure or no label found.\n"</span><span class="operator">;</span><span class="flow">
				break</span><span class="operator">;</span><span class="flow">
			case</span> TOK_JNE<span class="operator">:</span><span class="flow">

				if</span><span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span><span class="int">0</span><span class="operator">].</span>op1<span class="operator"> ==</span> labels<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>proc<span class="operator">) {</span><span class="flow">

					if</span><span class="operator">(</span>reg<span class="operator">[</span><span class="int">0</span><span class="operator">] ==</span><span class="bool"> false</span><span class="operator">)</span> inc<span class="operator"> =</span> labels<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>pos<span class="operator">;
				}</span><span class="flow">

				else</span>
					std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span><span class="string"> "***** on jmp instruction wrong procedure or no label found.\n"</span><span class="operator">;</span><span class="flow">

				break</span><span class="operator">;</span><span class="flow">

			case</span> TOK_JE<span class="operator">:</span><span class="flow">
				if</span><span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span><span class="int">0</span><span class="operator">].</span>op1<span class="operator"> ==</span> labels<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>proc<span class="operator">) {</span><span class="flow">

					if</span><span class="operator">(</span>reg<span class="operator">[</span><span class="int">0</span><span class="operator">] ==</span><span class="bool"> true</span><span class="operator">)</span> inc<span class="operator"> =</span> labels<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>pos<span class="operator">;
				}</span><span class="flow">

				else</span>
					std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span><span class="string"> "***** on jmp instruction wrong procedure or no label found.\n"</span><span class="operator">;</span><span class="flow">

				break</span><span class="operator">;</span><span class="flow">

			case</span> TOK_JL<span class="operator">:</span><span class="flow">
				if</span><span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span><span class="int">0</span><span class="operator">].</span>op1<span class="operator"> ==</span> labels<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>proc<span class="operator">) {</span><span class="flow">

					if</span><span class="operator">(</span>reg<span class="operator">[</span><span class="int">1</span><span class="operator">] !=</span><span class="bool"> true</span><span class="operator">)</span> inc<span class="operator"> =</span> labels<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>pos<span class="operator">;
				}</span><span class="flow">

				else</span>
					std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span><span class="string"> "***** on jmp instruction wrong procedure or no label found.\n"</span><span class="operator">;</span><span class="flow">

				break</span><span class="operator">;</span><span class="flow">

			case</span> TOK_JG<span class="operator">:</span><span class="flow">
				if</span><span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span><span class="int">0</span><span class="operator">].</span>op1<span class="operator"> ==</span> labels<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>proc<span class="operator">) {</span><span class="flow">

					if</span><span class="operator">(</span>reg<span class="operator">[</span><span class="int">1</span><span class="operator">] ==</span><span class="bool"> true</span><span class="operator">)</span> inc<span class="operator"> =</span> labels<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>pos<span class="operator">;
				}</span><span class="flow">

				else</span>
					std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span><span class="string"> "***** on jmp instruction wrong procedure or no label found.\n"</span><span class="operator">;</span><span class="flow">
			case</span> TOK_JLE<span class="operator">:</span><span class="flow">

				if</span><span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span><span class="int">0</span><span class="operator">].</span>op1<span class="operator"> ==</span> labels<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>proc<span class="operator">) {</span><span class="flow">

					if</span><span class="operator">(</span>reg<span class="operator">[</span><span class="int">3</span><span class="operator">] ==</span><span class="bool"> true</span><span class="operator">)</span> inc<span class="operator"> =</span> labels<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>pos<span class="operator">;
				}</span><span class="flow">

				else</span>
					std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span><span class="string"> "***** on jmp instruction wrong procedure or no label found.\n"</span><span class="operator">;</span><span class="flow">
				break</span><span class="operator">;</span><span class="flow">
			case</span> TOK_JGE<span class="operator">:</span><span class="flow">

				if</span><span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span><span class="int">0</span><span class="operator">].</span>op1<span class="operator"> ==</span> labels<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>proc<span class="operator">) {</span><span class="flow">

					if</span><span class="operator">(</span>reg<span class="operator">[</span><span class="int">2</span><span class="operator">] ==</span><span class="bool"> true</span><span class="operator">)</span> inc<span class="operator"> =</span> labels<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>pos<span class="operator">;
				}</span><span class="flow">

				else</span>
					std<span class="operator">::</span>cout<span class="operator"> &lt;&lt;</span><span class="string"> "***** on jmp instruction wrong procedure or no label found.\n"</span><span class="operator">;</span><span class="flow">
				break</span><span class="operator">;</span><span class="flow">

			case</span> TOK_CMP<span class="operator">:
				{</span><span class="flow">
					if</span><span class="operator">(</span>IsVar<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">)) {</span><span class="flow">

						if</span><span class="operator">(</span>IsVar<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">)) {</span>

							reg<span class="operator">[</span><span class="int">0</span><span class="operator">] = (</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator"> ==</span> symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">].</span>val<span class="operator">);</span>

							reg<span class="operator">[</span><span class="int">1</span><span class="operator">] = (</span>std<span class="operator">::</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">()) &gt;</span> std<span class="operator">::</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">()));</span>

							reg<span class="operator">[</span><span class="int">2</span><span class="operator">] = (</span>std<span class="operator">::</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">()) &gt;=</span> std<span class="operator">::</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">()));</span>

							reg<span class="operator">[</span><span class="int">3</span><span class="operator">] = (</span>std<span class="operator">::</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">()) &lt;=</span> std<span class="operator">::</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">()));

						}</span><span class="flow">

						else</span><span class="operator"> {</span>

							reg<span class="operator">[</span><span class="int">0</span><span class="operator">] = (</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator"> ==</span> ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">);</span>

							reg<span class="operator">[</span><span class="int">1</span><span class="operator">] = (</span>std<span class="operator">::</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">()) &gt;</span> std<span class="operator">::</span>atof<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>c_str<span class="operator">()));</span>

							reg<span class="operator">[</span><span class="int">2</span><span class="operator">] = (</span>std<span class="operator">::</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">()) &gt;=</span> std<span class="operator">::</span>atof<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>c_str<span class="operator">()));</span>

							reg<span class="operator">[</span><span class="int">3</span><span class="operator">] = (</span>std<span class="operator">::</span>atof<span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op1<span class="operator">].</span>val<span class="operator">.</span>c_str<span class="operator">()) &lt;=</span> std<span class="operator">::</span>atof<span class="operator">(</span>ins<span class="operator">[</span>block<span class="operator">][</span>inc<span class="operator">].</span>op2<span class="operator">.</span>c_str<span class="operator">()));
						}
					}
				}</span><span class="flow">

				break</span><span class="operator">;</span><span class="flow">
			case</span> TOK_RET<span class="operator">:
				{</span><span class="flow">
					return</span> PROC_RET<span class="operator">;
				}</span><span class="flow">
				break</span><span class="operator">;</span><span class="flow">

			case</span> TOK_EXIT<span class="operator">:
				{</span>
					std<span class="operator">::</span>exit<span class="operator">(</span><span class="int">0</span><span class="operator">);
				}</span><span class="flow">
				break</span><span class="operator">;

		}</span><span class="flow">

		return</span> PROC_CONT<span class="operator">;
	}</span>

	size_t BackEnd<span class="operator">::</span>Find<span class="operator">(</span>std<span class="operator">::</span>string what<span class="operator">) {</span><span class="flow">

		for</span><span class="operator">(</span>size_t i<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> i<span class="operator"> &lt;</span> ins<span class="operator">.</span>size<span class="operator">();</span> i<span class="operator">++)</span><span class="flow">

			if</span><span class="operator">(</span>strcmp<span class="operator">(</span>ins<span class="operator">[</span>i<span class="operator">][</span><span class="int">0</span><span class="operator">].</span>op1<span class="operator">.</span>c_str<span class="operator">(),</span>what<span class="operator">.</span>c_str<span class="operator">()) ==</span><span class="int"> 0</span><span class="operator">)</span><span class="flow">

				return</span> i<span class="operator">;</span><span class="flow">
		return</span><span class="int"> 0</span><span class="operator">;
	}</span><span class="type">

	void</span> BackEnd<span class="operator">::</span>AddExternal<span class="operator">(</span>std<span class="operator">::</span>string name<span class="operator">,</span><span class="type"> int</span><span class="operator"> (*</span>f<span class="operator">)(</span>Symbol_Table<span class="operator"> &amp;</span>t<span class="operator">)) {</span>

		callb<span class="operator">[</span>name<span class="operator">].</span>f<span class="operator"> =</span> f<span class="operator">;</span>
		callb<span class="operator">[</span>name<span class="operator">].</span>name<span class="operator"> =</span> name<span class="operator">;
	}</span><span class="type">

	bool</span> BackEnd<span class="operator">::</span>IsVar<span class="operator">(</span>std<span class="operator">::</span>string<span class="operator"> &amp;</span>name<span class="operator">) {</span><span class="flow">
		if</span><span class="operator">(</span>symbols<span class="operator">.</span>vars<span class="operator">[</span>name<span class="operator">].</span>name<span class="operator"> ==</span><span class="string"> ""</span><span class="operator">)</span><span class="flow">

			return</span><span class="bool"> false</span><span class="operator">;</span><span class="flow">
		return</span><span class="bool"> true</span><span class="operator">;
	}</span>

	std<span class="operator">::</span>string BackEnd<span class="operator">::</span>byteToString<span class="operator">(</span><span class="type">unsigned char</span> type<span class="operator">) {</span>

		std<span class="operator">::</span>string s<span class="operator">;</span><span class="flow">
		switch</span><span class="operator">(</span>type<span class="operator">) {</span><span class="flow">
			case</span><span class="int"> 1</span><span class="operator">:</span><span class="flow">

				return</span><span class="string"> "Identifier"</span><span class="operator">;</span><span class="flow">
			case</span><span class="int"> 2</span><span class="operator">:</span><span class="flow">
				return</span><span class="string"> "Digit"</span><span class="operator">;</span><span class="flow">

			case</span><span class="int"> 3</span><span class="operator">:</span><span class="flow">
				return</span><span class="string"> "String"</span><span class="operator">;</span><span class="flow">
			case</span><span class="int"> 4</span><span class="operator">:</span><span class="flow">

				return</span><span class="string"> "Code Label"</span><span class="operator">;
		}</span>

		s<span class="operator"> +=</span> type<span class="operator">;</span><span class="flow">
		return</span> s<span class="operator">;
	}</span>

	std<span class="operator">::</span>string BackEnd<span class="operator">::</span>tokenTypeToString<span class="operator">(</span>TOK_TYPE t<span class="operator">) {</span>
		std<span class="operator">::</span>string s<span class="operator">;</span><span class="flow">

		switch</span><span class="operator">(</span>t<span class="operator">) {</span><span class="flow">
			case</span><span class="int"> 0</span><span class="operator">:</span><span class="flow">
				return</span><span class="string"> "Constant"</span><span class="operator">;</span><span class="flow">

			case</span> VAR_INTEGER<span class="operator">:</span><span class="flow">
				return</span><span class="string"> "Integer"</span><span class="operator">;</span><span class="flow">
			case</span> VAR_STRING<span class="operator">:</span><span class="flow">

				return</span><span class="string"> "String"</span><span class="operator">;</span><span class="flow">
			case</span> VAR_FLOAT<span class="operator">:</span><span class="flow">
				return</span><span class="string"> "Float"</span><span class="operator">;
		}</span>

		s<span class="operator"> +=</span><span class="type"> int</span><span class="operator">(</span>t<span class="operator">);</span><span class="flow">
		return</span> s<span class="operator">;
	}</span><span class="type">

	void</span> BackEnd<span class="operator">::</span>DebugHTML<span class="operator">(</span>std<span class="operator">::</span>string src<span class="operator">,</span><span class="type"> bool</span> sout<span class="operator">) {</span>

		std<span class="operator">::</span>fstream file<span class="operator">;</span>
		file<span class="operator">.</span>open<span class="operator">(</span>src<span class="operator">.</span>c_str<span class="operator">(),</span> std<span class="operator">::</span>ios<span class="operator">::</span>out<span class="operator">);</span><span class="flow">

		if</span><span class="operator">(</span>file<span class="operator">.</span>is_open<span class="operator">()) {</span>
			size_t i<span class="operator"> =</span><span class="int"> 0</span><span class="operator">,</span> z<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span>

			file<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;HTML&gt;&lt;TITLE&gt;Masc Debug Output File for "</span><span class="operator"> &lt;&lt;</span> prog_name<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;/TITLE&gt;&lt;BODY&gt;"</span><span class="operator">;</span>

			file<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;font face=\"FixedSys\" size=\"4\" color=\"black\"&gt;&lt;TABLE border=\"4\" bgcolor=\"#FFFFFF\" BORDERCOLOR=\"#000000\" CELLPADDING=\"3\" CELLSPACING=\"0\"&gt;&lt;br&gt;"</span><span class="operator">;</span>
			file<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;TR&gt;&lt;font color=\"#BD0000\"&gt; Tokenized Code &lt;/font&gt; &lt;/TR&gt;&lt;br&gt;&lt;TH&gt; File/Line &lt;/TH&gt;&lt;TH&gt; Byte Code &lt;/TH&gt;&lt;TH&gt; Symbols &lt;/TH&gt;"</span><span class="operator">;</span><span class="flow">

			for</span><span class="operator">(</span>i<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> i<span class="operator"> &lt;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">.</span>size<span class="operator">();</span> i<span class="operator">++)</span>

				file<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;TR&gt;&lt;TH&gt;&lt;font color=\"blue\"&gt;"</span><span class="operator"> &lt;&lt;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>source_file<span class="operator"> &lt;&lt;</span><span class="string"> ":"</span><span class="operator"> &lt;&lt;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>line_num<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;/TH&gt;&lt;TH&gt;"</span><span class="operator"> &lt;&lt;</span> byteToString<span class="operator">(</span>p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>type<span class="operator">) &lt;&lt;</span><span class="string"> "&lt;/font&gt;&lt;/TH&gt;&lt;TH&gt;&lt;font color=\"A0A0A0\"&gt;"</span><span class="operator"> &lt;&lt;</span> p<span class="operator">-&gt;</span>tok_vec<span class="operator">[</span>i<span class="operator">].</span>token<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;/font&gt;&lt;/TH&gt;"</span><span class="operator">;</span>

			file<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;/TABLE&gt;&lt;TABLE border =\"4\" bgcolor=\"#FFFFFF\" BORDERCOLOR=\"#000000\" CELLPADDING=\"3\" CELLSPACING=\"0\"&gt; &lt;br&gt; &lt;TR&gt;&lt;font color=\"#BD0000\"&gt; Intermediate Code&lt;/font&gt;&lt;/TR&gt;&lt;br&gt;&lt;TH&gt; OpCode &lt;/TH&gt;&lt;TH&gt; Operand 1 &lt;/TH&gt; &lt;TH&gt; Operand 2 &lt;/TH&gt;"</span><span class="operator">;</span><span class="flow">

			for</span><span class="operator">(</span>i<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> i<span class="operator"> &lt;</span> ins<span class="operator">.</span>size<span class="operator">();</span> i<span class="operator">++)</span><span class="flow">

				for</span><span class="operator">(</span>z<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> z<span class="operator"> &lt;</span> ins<span class="operator">[</span>i<span class="operator">].</span>size<span class="operator">();</span> z<span class="operator">++)</span>

					file<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;TR&gt;&lt;TH&gt;&lt;font color=\"orange\"&gt; "</span><span class="operator"> &lt;&lt;  (</span>ins<span class="operator">[</span>i<span class="operator">][</span>z<span class="operator">].</span>op_code<span class="operator"> ==</span><span class="int"> 0xFF</span><span class="operator"> ?</span><span class="string"> "Code Block"</span><span class="operator"> : (</span>ins<span class="operator">[</span>i<span class="operator">][</span>z<span class="operator">].</span>op_code<span class="operator"> &lt;=</span> TOK_PRINT<span class="operator"> ?</span> tok_array<span class="operator">[</span><span class="type">int</span><span class="operator">(</span>ins<span class="operator">[</span>i<span class="operator">][</span>z<span class="operator">].</span>op_code<span class="operator">)] :</span><span class="string"> "Unknown"</span><span class="operator">)) &lt;&lt;</span><span class="string"> " ("</span><span class="operator"> &lt;&lt;</span><span class="type"> int</span><span class="operator">(</span>ins<span class="operator">[</span>i<span class="operator">][</span>z<span class="operator">].</span>op_code<span class="operator">) &lt;&lt;</span><span class="string"> ")&lt;/font&gt;&lt;/TH&gt; &lt;TH&gt;&lt;font color=\"purple\"&gt;"</span><span class="operator"> &lt;&lt;</span> ins<span class="operator">[</span>i<span class="operator">][</span>z<span class="operator">].</span>op1<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;/font&gt;&lt;/TH&gt;"</span><span class="operator"> &lt;&lt;</span><span class="string"> "&lt;TH&gt;&lt;font color=\"purple\"&gt;"</span><span class="operator"> &lt;&lt;</span> ins<span class="operator">[</span>i<span class="operator">][</span>z<span class="operator">].</span>op2<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;/font&gt;&lt;/TH&gt;"</span><span class="operator">;</span>

			file<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;/TABLE&gt;&lt;TABLE border =\"4\" bgcolor=\"#FFFFFF\" BORDERCOLOR=\"#000000\" CELLPADDING=\"3\" CELLSPACING=\"0\"&gt; &lt;br&gt; &lt;TR&gt;&lt;font color=\"#BD0000\"&gt; Symbol Table &lt;/font&gt;&lt;/TR&gt;&lt;br&gt;&lt;TH&gt; String Name &lt;/TH&gt;&lt;TH&gt; Value &lt;/TH&gt; &lt;TH&gt; Type &lt;/TH&gt;"</span><span class="operator">;</span>

			std<span class="operator">::</span>map<span class="operator">&lt;</span>std<span class="operator">::</span>string<span class="operator">,</span>symb<span class="operator">&gt;::</span>const_iterator x<span class="operator">;</span><span class="flow">
			for</span><span class="operator">(</span>x<span class="operator"> =</span> symbols<span class="operator">.</span>vars<span class="operator">.</span>begin<span class="operator">();</span> x<span class="operator"> !=</span> symbols<span class="operator">.</span>vars<span class="operator">.</span>end<span class="operator">();</span> x<span class="operator">++)</span>

				file<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;TR&gt;&lt;TH&gt;&lt;font color=\"teal\"&gt;"</span><span class="operator"> &lt;&lt;</span>  x<span class="operator">-&gt;</span>first<span class="operator">  &lt;&lt;</span><span class="string"> "&lt;/font&gt;&lt;/TH&gt; &lt;TH&gt;&lt;font color=\"green\"&gt;"</span><span class="operator"> &lt;&lt;</span> x<span class="operator">-&gt;</span>second<span class="operator">.</span>val<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;/font&gt;&lt;/TH&gt;"</span><span class="operator"> &lt;&lt;</span><span class="string"> "&lt;TH&gt;&lt;font color=\"red\"&gt;"</span><span class="operator"> &lt;&lt;</span> tokenTypeToString<span class="operator">(</span>TOK_TYPE<span class="operator">(</span>x<span class="operator">-&gt;</span>second<span class="operator">.</span>type<span class="operator">)) &lt;&lt;</span><span class="string"> "&lt;/font&gt;&lt;/TH&gt;"</span><span class="operator">;</span>

			std<span class="operator">::</span>map<span class="operator">&lt;</span>std<span class="operator">::</span>string<span class="operator">,</span> masc<span class="operator">::</span>External_Callback<span class="operator">&gt;::</span>iterator y<span class="operator">;</span>

			file<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;/TABLE&gt;&lt;TABLE border =\"4\" bgcolor=\"#FFFFFF\" BORDERCOLOR=\"#000000\" CELLPADDING=\"3\" CELLSPACING=\"0\"&gt; &lt;br&gt; &lt;TR&gt;&lt;font color=\"#BD0000\"&gt; External Callbacks &lt;/font&gt;&lt;/TR&gt;&lt;br&gt;&lt;TH&gt; Procedure Name &lt;/TH&gt; &lt;TH&gt; Address &lt;/TH&gt;"</span><span class="operator">;</span><span class="flow">

			for</span><span class="operator">(</span>y<span class="operator"> =</span> callb<span class="operator">.</span>begin<span class="operator">();</span> y<span class="operator"> !=</span> callb<span class="operator">.</span>end<span class="operator">();</span> y<span class="operator">++)</span>

				file<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;TR&gt;&lt;TH&gt;&lt;font color=\"purple\"&gt;"</span><span class="operator"> &lt;&lt;</span>  y<span class="operator">-&gt;</span>first<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;/font&gt;&lt;/TH&gt; &lt;TH&gt;&lt;font color=\"green\"&gt;"</span><span class="operator"> &lt;&lt;</span> y<span class="operator">-&gt;</span>second<span class="operator">.</span>f<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;/font&gt;&lt;/TH&gt;"</span><span class="operator">;</span>

			file<span class="operator"> &lt;&lt;</span><span class="string"> "&lt;font&gt;&lt;/TABLE&gt;&lt;/BODY&gt;&lt;/HTML&gt;"</span><span class="operator">;</span>		
			file<span class="operator">.</span>close<span class="operator">();
		}</span><span class="comment">

		// dump debug output to stdout
</span><span class="flow">		if</span><span class="operator">(</span>sout<span class="operator"> ==</span><span class="bool"> true</span><span class="operator">) {</span>
			std<span class="operator">::</span>fstream ifile<span class="operator">;</span>

			cout<span class="operator"> &lt;&lt;</span><span class="string"> "Content-type: text/html\n\n"</span><span class="operator">;</span>
			ifile<span class="operator">.</span>open<span class="operator">(</span>src<span class="operator">.</span>c_str<span class="operator">(),</span>std<span class="operator">::</span>ios<span class="operator">::</span>in<span class="operator">);</span><span class="flow">

			while</span><span class="operator">(</span>ifile<span class="operator">.</span>is_open<span class="operator">() &amp;&amp; !</span>ifile<span class="operator">.</span>eof<span class="operator">()) {</span>
				std<span class="operator">::</span>string s<span class="operator">;</span>

				std<span class="operator">::</span>getline<span class="operator">(</span>ifile<span class="operator">,</span>s<span class="operator">);</span>
				cout<span class="operator"> &lt;&lt;</span> s<span class="operator"> &lt;&lt;</span><span class="string"> "\n"</span><span class="operator">;
			}</span>

			ifile<span class="operator">.</span>close<span class="operator">();
		}
	}</span><span class="keyword">

	inline</span><span class="type"> int</span> IdentToValue<span class="operator">(</span>std<span class="operator">::</span>string s<span class="operator">) {</span><span class="flow">

		for</span><span class="operator">(</span><span class="type">int</span> i<span class="operator"> =</span><span class="int"> 0</span><span class="operator">;</span> tok_array<span class="operator">[</span>i<span class="operator">] !=</span><span class="int"> 0</span><span class="operator">;</span> i<span class="operator">++)</span><span class="flow"> 
			if</span><span class="operator">(</span>s<span class="operator"> ==</span> tok_array<span class="operator">[</span>i<span class="operator">])</span><span class="flow">

				return</span> i<span class="operator">;</span><span class="flow">
		return</span><span class="operator"> -</span><span class="int">1</span><span class="operator">;
	}</span>

	
	BackEnd<span class="operator"> *</span>BackEnd<span class="operator">::</span>back<span class="operator">;
}</span>

</pre>
</body>
</html>
